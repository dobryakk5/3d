============================================================
СОЗДАНИЕ ВЕКТОРНОЙ ВИЗУАЛИЗАЦИИ НА ОСНОВЕ ПРОЕМОВ С АНАЛИЗОМ ТИПОВ JUNCTIONS
============================================================
Загрузка данных из: 1_objects.json
  ✓ Данные успешно загружены
  ✓ Толщина стен определена по минимальной толщине дверей: 22.0 px

============================================================
ОБРАБОТКА ПРОЕМОВ С УЧЕТОМ JUNCTIONS
============================================================
  ✓ Загружено 36 junctions
Обработка 12 проемов:
  Вызов construct_wall_segment_from_opening для проема window_2
    DEBUG: Обработка проема window_2, ориентация: horizontal
    DEBUG: Проверка проема window_2 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема window_2 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_2 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_4
    DEBUG: Обработка проема window_4, ориентация: horizontal
    DEBUG: Проверка проема window_4 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема window_4 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_4 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема door_1
    DEBUG: Обработка проема door_1, ориентация: horizontal
    DEBUG: Проверка проема door_1 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема door_1 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_1 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема door_2
    DEBUG: Обработка проема door_2, ориентация: horizontal
    DEBUG: Проверка проема door_2 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема door_2 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_2 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_3
    DEBUG: Обработка проема window_3, ориентация: vertical
    DEBUG: Проверка проема window_3 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема window_3 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_3 (vertical): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_7
    DEBUG: Обработка проема window_7, ориентация: vertical
    DEBUG: Проверка проема window_7 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема window_7 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_7 (vertical): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_5
    DEBUG: Обработка проема window_5, ориентация: vertical
    DEBUG: Проверка проема window_5 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема window_5 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_5 (vertical): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_6
    DEBUG: Обработка проема window_6, ориентация: vertical
    DEBUG: Проверка проема window_6 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема window_6 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_6 (vertical): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_1
    DEBUG: Обработка проема window_1, ориентация: horizontal
    DEBUG: Проверка проема window_1 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема window_1 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_1 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема door_3
    DEBUG: Обработка проема door_3, ориентация: vertical
    DEBUG: Проверка проема door_3 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    Нет подходящего junction — попытка дотянуть до края полигона (проем door_3, top)
    ✓ Край полигона найден: up=718.9. Строим до него
    DEBUG: Проверка проема door_3 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_3 (vertical): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема door_4
    DEBUG: Обработка проема door_4, ориентация: horizontal
    DEBUG: Проверка проема door_4 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема door_4 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_4 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема door_5
    DEBUG: Обработка проема door_5, ориентация: vertical
    DEBUG: Проверка проема door_5 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема door_5 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_5 (vertical): 2 сегментов

Всего создано 24 сегментов стен из 12 проемов

============================================================
ОБРАБОТКА КОЛОНН И СОЗДАНИЕ КВАДРАТОВ
============================================================
  Найдено 2 полигонов колонн
  Найдено 2 колонн
  Используем только pillar_polygons для избежания дублирования
  ✓ Создан квадрат для колонны P1: центр(218.6, 1091.1), размер 22.0x22.0
  ✓ Создан квадрат для колонны P2: центр(502.2, 1093.2), размер 22.0x22.0

  ✓ Всего создано квадратов колонн: 2

============================================================
АНАЛИЗ ТИПОВ JUNCTIONS С УЛУЧШЕННОЙ ЛОГИКОЙ
============================================================
  ✓ Загружено 36 junctions
Анализ типов 36 junctions с улучшенной логикой...
  Junction 1 (615.0, 799.0): тип=L, направления=left, up
  Junction 2 (1082.0, 1092.0): тип=L, направления=left, up
  Junction 3 (216.0, 976.0): тип=L, направления=right, up
  Junction 4 (787.0, 1092.0): тип=L, направления=right, up
  Junction 5 (215.0, 151.0): тип=L, направления=right, down
  Junction 6 (1082.0, 150.0): тип=L, направления=left, down
  Junction 7 (615.0, 617.0): тип=L, направления=left, down
  Junction 8 (416.0, 617.0): тип=T, направления=left, right, down
  Junction 9 (787.0, 977.0): тип=T, направления=left, up, down
  Junction 10 (417.0, 975.0): тип=T, направления=left, right, up
  Junction 11 (215.0, 616.0): тип=T, направления=right, up, down
  Junction 12 (417.0, 801.0): тип=T, направления=right, up, down
  Junction 13 (287.0, 150.0): тип=unknown, направления=left
  Junction 14 (622.0, 151.0): тип=unknown (не внутри полигона)
  Junction 15 (279.0, 616.0): тип=unknown (не внутри полигона)
  Junction 16 (623.0, 977.0): тип=unknown (не внутри полигона)
  Junction 17 (279.0, 979.0): тип=unknown (не внутри полигона)
  Junction 18 (821.0, 1091.0): тип=unknown (не внутри полигона)
  Junction 19 (442.0, 150.0): тип=unknown, направления=right
  Junction 20 (716.0, 151.0): тип=unknown (не внутри полигона)
  Junction 21 (348.0, 617.0): тип=unknown (не внутри полигона)
  Junction 22 (369.0, 977.0): тип=unknown (не внутри полигона)
  Junction 23 (754.0, 977.0): тип=unknown (не внутри полигона)
  Junction 24 (1046.0, 1092.0): тип=unknown (не внутри полигона)
  Junction 25 (216.0, 220.0): тип=unknown, направления=up
  Junction 26 (1080.0, 526.0): тип=unknown (не внутри полигона)
  Junction 27 (1081.0, 633.0): тип=unknown (не внутри полигона)
  Junction 28 (615.0, 657.0): тип=unknown, направления=up
  Junction 29 (216.0, 677.0): тип=unknown (не внутри полигона)
  Junction 30 (788.0, 812.0): тип=unknown (не внутри полигона)
  Junction 31 (216.0, 375.0): тип=unknown, направления=down
  Junction 32 (1080.0, 588.0): тип=unknown (не внутри полигона)
  Junction 33 (1080.0, 696.0): тип=unknown (не внутри полигона)
  Junction 34 (616.0, 727.0): тип=unknown (не внутри полигона)
  Junction 35 (216.0, 738.0): тип=unknown (не внутри полигона)
  Junction 36 (788.0, 902.0): тип=unknown (не внутри полигона)

Статистика типов junctions:
  L: 7
  T: 5
  unknown: 24

============================================================
ПОИСК JUNCTIONS НЕ СВЯЗАННЫХ С ПРОЕМАМИ И ДОСТРАИВАНИЕ СТЕН
============================================================

--- Итерация 1 ---
  ✓ Найдено 7 junctions для обработки
  Обработка junction 1...
  Junction 1: существующие направления=['up'], требуемые=['left', 'up'], недостающие=['left']
    ✓ Создан сегмент от J1 до J12 в направлении left

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J1 до J12
  ✓ Создано 1 новых уникальных сегментов для junction 1
  Обработка junction 4...
  Junction 4: существующие направления=['right'], требуемые=['right', 'up'], недостающие=['up']
    ✓ Создан сегмент от J4 до J9 в направлении up

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J4 до J9
  ✓ Создано 1 новых уникальных сегментов для junction 4
  Обработка junction 7...
  Junction 7: существующие направления=['down'], требуемые=['left', 'down'], недостающие=['left']
    ✓ Создан сегмент от J7 до J8 в направлении left

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J7 до J8
  ✓ Создано 1 новых уникальных сегментов для junction 7
  Обработка junction 8...
  Junction 8: существующие направления=['right', 'left'], требуемые=['left', 'right', 'down'], недостающие=['down']
    ✓ Создан сегмент от J8 до J12 в направлении down

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J8 до J12
  ✓ Создано 1 новых уникальных сегментов для junction 8
  Обработка junction 9...
  Junction 9: существующие направления=['up', 'down', 'left'], требуемые=['left', 'up', 'down'], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 9
  Обработка junction 10...
  Junction 10: существующие направления=['right', 'left'], требуемые=['left', 'right', 'up'], недостающие=['up']
    ✓ Создан сегмент от J10 до J12 в направлении up

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J10 до J12
  ✓ Создано 1 новых уникальных сегментов для junction 10
  Обработка junction 12...
  Junction 12: существующие направления=['up', 'down', 'right'], требуемые=['right', 'up', 'down'], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 12
  ✓ Добавлено 5 сегментов на итерации 1

--- Итерация 2 ---
  ✓ Найдено 0 junctions для обработки
  ✓ Все junctions связаны с проемами или уже имеют достаточное количество сегментов стен

============================================================
ОБРАБОТКА L-JUNCTIONS И РАСШИРЕНИЕ ОРИГИНАЛЬНЫХ СЕГМЕНТОВ
============================================================
  ✓ Найдено 7 L-junctions
  Обработка L-junction 1 (615.0, 799.0)
    ✓ Выбран сегмент для расширения: wall_door_5_bottom_34_to_1
    ✓ Оригинальные границы segment bbox: {'x': 603.0, 'y': 727.0, 'width': 22.0, 'height': 71.0, 'orientation': 'vertical'}
    ✓ Выбран перпендикулярный сегмент: wall_junction_1_to_12_left
    → Шаг 1: Расширение до перпендикулярного bbox (дальняя сторона)...
    ✓ Сегмент wall_door_5_bottom_34_to_1 расширен вниз до 810.0 (bbox перпендикуляра)
    ✓ После расширения до перпендикуляра: {'x': 603.0, 'y': 727.0, 'width': 22.0, 'height': 83.0, 'orientation': 'vertical'}
    ✓ Итог: Сегмент wall_door_5_bottom_34_to_1 расширен
      оригинал: {'x': 603.0, 'y': 727.0, 'width': 22.0, 'height': 71.0, 'orientation': 'vertical'}
      результат: {'x': 603.0, 'y': 727.0, 'width': 22.0, 'height': 83.0, 'orientation': 'vertical'}
  Обработка L-junction 2 (1082.0, 1092.0)
    ✓ Выбран сегмент для расширения: wall_window_6_bottom_33_to_2
    ✓ Оригинальные границы segment bbox: {'x': 1069.0, 'y': 696.0, 'width': 22.0, 'height': 397.0, 'orientation': 'vertical'}
    ✓ Выбран перпендикулярный сегмент: wall_window_1_right_24_to_2
    → Шаг 1: Расширение до перпендикулярного bbox (дальняя сторона)...
    ✓ Сегмент wall_window_6_bottom_33_to_2 расширен вниз до 1102.0 (bbox перпендикуляра)
    ✓ После расширения до перпендикуляра: {'x': 1069.0, 'y': 696.0, 'width': 22.0, 'height': 406.0, 'orientation': 'vertical'}
    ✓ Итог: Сегмент wall_window_6_bottom_33_to_2 расширен
      оригинал: {'x': 1069.0, 'y': 696.0, 'width': 22.0, 'height': 397.0, 'orientation': 'vertical'}
      результат: {'x': 1069.0, 'y': 696.0, 'width': 22.0, 'height': 406.0, 'orientation': 'vertical'}
  Обработка L-junction 3 (216.0, 976.0)
    ✓ Выбран сегмент для расширения: wall_door_2_left_17_to_3
    ✓ Оригинальные границы segment bbox: {'x': 216.0, 'y': 966.5, 'width': 63.0, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Выбран перпендикулярный сегмент: wall_window_7_bottom_35_to_3
    → Шаг 1: Расширение до перпендикулярного bbox (дальняя сторона)...
    ✓ Сегмент wall_door_2_left_17_to_3 расширен влево до 204.5 (bbox перпендикуляра)
    ✓ После расширения до перпендикуляра: {'x': 204.5, 'y': 966.5, 'width': 74.5, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_door_2_left_17_to_3 расширен
      оригинал: {'x': 216.0, 'y': 966.5, 'width': 63.0, 'height': 22.0, 'orientation': 'horizontal'}
      результат: {'x': 204.5, 'y': 966.5, 'width': 74.5, 'height': 22.0, 'orientation': 'horizontal'}
  Обработка L-junction 4 (787.0, 1092.0)
    ✓ Выбран сегмент для расширения: wall_window_1_left_18_to_4
    ✓ Оригинальные границы segment bbox: {'x': 787.0, 'y': 1080.0, 'width': 34.0, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Выбран перпендикулярный сегмент: wall_junction_4_to_9_up
    → Шаг 1: Расширение до перпендикулярного bbox (дальняя сторона)...
    ✓ Сегмент wall_window_1_left_18_to_4 расширен влево до 776.0 (bbox перпендикуляра)
    ✓ После расширения до перпендикуляра: {'x': 776.0, 'y': 1080.0, 'width': 45.0, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_window_1_left_18_to_4 расширен
      оригинал: {'x': 787.0, 'y': 1080.0, 'width': 34.0, 'height': 22.0, 'orientation': 'horizontal'}
      результат: {'x': 776.0, 'y': 1080.0, 'width': 45.0, 'height': 22.0, 'orientation': 'horizontal'}
  Обработка L-junction 5 (215.0, 151.0)
    ✓ Выбран сегмент для расширения: wall_window_2_left_13_to_5
    ✓ Оригинальные границы segment bbox: {'x': 215.0, 'y': 139.0, 'width': 72.0, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Выбран перпендикулярный сегмент: wall_window_3_top_25_to_5
    → Шаг 1: Расширение до перпендикулярного bbox (дальняя сторона)...
    ✓ Сегмент wall_window_2_left_13_to_5 расширен влево до 204.5 (bbox перпендикуляра)
    ✓ После расширения до перпендикуляра: {'x': 204.5, 'y': 139.0, 'width': 82.5, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_window_2_left_13_to_5 расширен
      оригинал: {'x': 215.0, 'y': 139.0, 'width': 72.0, 'height': 22.0, 'orientation': 'horizontal'}
      результат: {'x': 204.5, 'y': 139.0, 'width': 82.5, 'height': 22.0, 'orientation': 'horizontal'}
  Обработка L-junction 6 (1082.0, 150.0)
    ✓ Выбран сегмент для расширения: wall_window_4_right_20_to_6
    ✓ Оригинальные границы segment bbox: {'x': 716.0, 'y': 139.0, 'width': 366.0, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Выбран перпендикулярный сегмент: wall_window_5_top_26_to_6
    → Шаг 1: Расширение до перпендикулярного bbox (дальняя сторона)...
    ✓ Сегмент wall_window_4_right_20_to_6 расширен вправо до 1091.0 (bbox перпендикуляра)
    ✓ После расширения до перпендикуляра: {'x': 716.0, 'y': 139.0, 'width': 375.0, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_window_4_right_20_to_6 расширен
      оригинал: {'x': 716.0, 'y': 139.0, 'width': 366.0, 'height': 22.0, 'orientation': 'horizontal'}
      результат: {'x': 716.0, 'y': 139.0, 'width': 375.0, 'height': 22.0, 'orientation': 'horizontal'}
  Обработка L-junction 7 (615.0, 617.0)
    ✓ Выбран сегмент для расширения: wall_door_5_top_28_to_7
    ✓ Оригинальные границы segment bbox: {'x': 603.0, 'y': 617.0, 'width': 22.0, 'height': 40.0, 'orientation': 'vertical'}
    ✓ Выбран перпендикулярный сегмент: wall_junction_7_to_8_left
    → Шаг 1: Расширение до перпендикулярного bbox (дальняя сторона)...
    ✓ Сегмент wall_door_5_top_28_to_7 расширен вверх до 606.0 (bbox перпендикуляра)
    ✓ После расширения до перпендикуляра: {'x': 603.0, 'y': 606.0, 'width': 22.0, 'height': 51.0, 'orientation': 'vertical'}
    ✓ Итог: Сегмент wall_door_5_top_28_to_7 расширен
      оригинал: {'x': 603.0, 'y': 617.0, 'width': 22.0, 'height': 40.0, 'orientation': 'vertical'}
      результат: {'x': 603.0, 'y': 606.0, 'width': 22.0, 'height': 51.0, 'orientation': 'vertical'}
  ✓ Расширено 7 сегментов для L-junctions

============================================================
ОБНОВЛЕНИЕ JSON ДАННЫХ С РАСШИРЕННЫМИ СЕГМЕНТАМИ
============================================================
  ✓ Обновлен сегмент из проема: wall_window_2_left_13_to_5
  ✓ Обновлен сегмент из проема: wall_window_2_right_19_to_14
  ✓ Обновлен сегмент из проема: wall_window_4_left_14_to_19
  ✓ Обновлен сегмент из проема: wall_window_4_right_20_to_6
  ✓ Обновлен сегмент из проема: wall_door_1_left_16_to_10
  ✓ Обновлен сегмент из проема: wall_door_1_right_23_to_9
  ✓ Обновлен сегмент из проема: wall_door_2_left_17_to_3
  ✓ Обновлен сегмент из проема: wall_door_2_right_22_to_10
  ✓ Обновлен сегмент из проема: wall_window_3_top_25_to_5
  ✓ Обновлен сегмент из проема: wall_window_3_bottom_31_to_11
  ✓ Обновлен сегмент из проема: wall_window_7_top_29_to_11
  ✓ Обновлен сегмент из проема: wall_window_7_bottom_35_to_3
  ✓ Обновлен сегмент из проема: wall_window_5_top_26_to_6
  ✓ Обновлен сегмент из проема: wall_window_5_bottom_32_to_27
  ✓ Обновлен сегмент из проема: wall_window_6_top_27_to_32
  ✓ Обновлен сегмент из проема: wall_window_6_bottom_33_to_2
  ✓ Обновлен сегмент из проема: wall_window_1_left_18_to_4
  ✓ Обновлен сегмент из проема: wall_window_1_right_24_to_2
  ✓ Обновлен сегмент из проема: wall_door_3_top_30_to_-100030_edge
  ✓ Обновлен сегмент из проема: wall_door_3_bottom_36_to_9
  ✓ Обновлен сегмент из проема: wall_door_4_left_15_to_11
  ✓ Обновлен сегмент из проема: wall_door_4_right_21_to_8
  ✓ Обновлен сегмент из проема: wall_door_5_top_28_to_7
  ✓ Обновлен сегмент из проема: wall_door_5_bottom_34_to_1
  ✓ Обновлен сегмент из junction: wall_junction_1_to_12_left
  ✓ Обновлен сегмент из junction: wall_junction_4_to_9_up
  ✓ Обновлен сегмент из junction: wall_junction_7_to_8_left
  ✓ Обновлен сегмент из junction: wall_junction_8_to_12_down
  ✓ Обновлен сегмент из junction: wall_junction_10_to_12_up
  ✓ JSON данные обновлены с 7 расширенными сегментами

============================================================
ДОБАВЛЕНИЕ ПРИВЯЗОК JUNCTIONS К СТЕНАМ
============================================================
  Обновление junctions привязками к сегментам стен...
  ✓ Обновление junctions завершено

============================================================
ВЫРАВНИВАНИЕ СТЕН ПО ПРОЕМАМ
============================================================
  Проверка на дубликаты сегментов:
    Сегменты из проемов: 24
    Сегменты из junctions: 5
  Начинаем выравнивание 24 сегментов из проемов и 5 сегментов из junctions
  ✓ Толщина стен определена по минимальной толщине дверей: 22.0 px
  ✓ Конвертировано 29 сегментов в единый формат
  ✓ Разделено на 14 горизонтальных и 15 вертикальных стен
  Обрабатываем горизонтальные стены...
  ✓ Найдено 4 групп горизонтальных стен
    Группа на Y=139.0: 4 стен
      Стена wall_window_2_left_13_to_5: bbox={'x': 204.5, 'y': 139.0, 'width': 82.5, 'height': 22.0, 'orientation': 'horizontal'}
      Стена wall_window_2_right_19_to_14: bbox={'x': 442.0, 'y': 139.0, 'width': 180.0, 'height': 22.0, 'orientation': 'horizontal'}
      Стена wall_window_4_left_14_to_19: bbox={'x': 442.0, 'y': 139.0, 'width': 180.0, 'height': 22.0, 'orientation': 'horizontal'}
      Стена wall_window_4_right_20_to_6: bbox={'x': 716.0, 'y': 139.0, 'width': 375.0, 'height': 22.0, 'orientation': 'horizontal'}
      Найдено 2 связанных проемов
    ✓ Стена wall_window_2_left_13_to_5: Y 139.0 -> 139.0 (по проему window_4)
    ✓ Стена wall_window_2_right_19_to_14: Y 139.0 -> 139.0 (по проему window_4)
    ✓ Стена wall_window_4_left_14_to_19: Y 139.0 -> 139.0 (по проему window_4)
    ✓ Стена wall_window_4_right_20_to_6: Y 139.0 -> 139.0 (по проему window_4)
    Группа на Y=966.5: 4 стен
      Стена wall_door_1_left_16_to_10: bbox={'x': 417.0, 'y': 966.5, 'width': 206.0, 'height': 22.0, 'orientation': 'horizontal'}
      Стена wall_door_1_right_23_to_9: bbox={'x': 754.0, 'y': 966.5, 'width': 33.0, 'height': 22.0, 'orientation': 'horizontal'}
      Стена wall_door_2_left_17_to_3: bbox={'x': 204.5, 'y': 966.5, 'width': 74.5, 'height': 22.0, 'orientation': 'horizontal'}
      Стена wall_door_2_right_22_to_10: bbox={'x': 369.0, 'y': 966.5, 'width': 48.0, 'height': 22.0, 'orientation': 'horizontal'}
      Найдено 2 связанных проемов
    ✓ Стена wall_door_1_left_16_to_10: Y 966.5 -> 966.5 (по проему door_2)
    ✓ Стена wall_door_1_right_23_to_9: Y 966.5 -> 966.5 (по проему door_2)
    ✓ Стена wall_door_2_left_17_to_3: Y 966.5 -> 966.5 (по проему door_2)
    ✓ Стена wall_door_2_right_22_to_10: Y 966.5 -> 966.5 (по проему door_2)
    Группа на Y=1080.0: 2 стен
      Стена wall_window_1_left_18_to_4: bbox={'x': 776.0, 'y': 1080.0, 'width': 45.0, 'height': 22.0, 'orientation': 'horizontal'}
      Стена wall_window_1_right_24_to_2: bbox={'x': 1046.0, 'y': 1080.0, 'width': 36.0, 'height': 22.0, 'orientation': 'horizontal'}
      Найдено 1 связанных проемов
    ✓ Стена wall_window_1_left_18_to_4: Y 1080.0 -> 1080.0 (по проему window_1)
    ✓ Стена wall_window_1_right_24_to_2: Y 1080.0 -> 1080.0 (по проему window_1)
    Группа на Y=604.5: 3 стен
      Стена wall_door_4_left_15_to_11: bbox={'x': 215.0, 'y': 604.5, 'width': 64.0, 'height': 22.0, 'orientation': 'horizontal'}
      Стена wall_door_4_right_21_to_8: bbox={'x': 348.0, 'y': 604.5, 'width': 68.0, 'height': 22.0, 'orientation': 'horizontal'}
      Стена wall_junction_7_to_8_left: bbox={'x': 416.0, 'y': 606.0, 'width': 199.0, 'height': 22.0, 'orientation': 'horizontal'}
      Найдено 1 связанных проемов
    ✓ Стена wall_door_4_left_15_to_11: Y 604.5 -> 604.5 (по проему door_4)
    ✓ Стена wall_door_4_right_21_to_8: Y 604.5 -> 604.5 (по проему door_4)
    ✓ Стена wall_junction_7_to_8_left: Y 606.0 -> 604.5 (по проему door_4)
  Обрабатываем вертикальные стены...
  ✓ Найдено 5 групп вертикальных стен
    Группа на X=204.5: 4 стен
      Стена wall_window_3_top_25_to_5: bbox={'x': 204.5, 'y': 151.0, 'width': 22.0, 'height': 69.0, 'orientation': 'vertical'}
      Стена wall_window_3_bottom_31_to_11: bbox={'x': 204.5, 'y': 375.0, 'width': 22.0, 'height': 241.0, 'orientation': 'vertical'}
      Стена wall_window_7_top_29_to_11: bbox={'x': 204.5, 'y': 616.0, 'width': 22.0, 'height': 61.0, 'orientation': 'vertical'}
      Стена wall_window_7_bottom_35_to_3: bbox={'x': 204.5, 'y': 738.0, 'width': 22.0, 'height': 237.0, 'orientation': 'vertical'}
      Найдено 2 связанных проемов
    ✓ Стена wall_window_3_top_25_to_5: X 204.5 -> 204.5 (по проему window_7)
    ✓ Стена wall_window_3_bottom_31_to_11: X 204.5 -> 204.5 (по проему window_7)
    ✓ Стена wall_window_7_top_29_to_11: X 204.5 -> 204.5 (по проему window_7)
    ✓ Стена wall_window_7_bottom_35_to_3: X 204.5 -> 204.5 (по проему window_7)
    Группа на X=1069.0: 4 стен
      Стена wall_window_5_top_26_to_6: bbox={'x': 1069.0, 'y': 152.0, 'width': 22.0, 'height': 374.0, 'orientation': 'vertical'}
      Стена wall_window_5_bottom_32_to_27: bbox={'x': 1069.0, 'y': 588.0, 'width': 22.0, 'height': 45.0, 'orientation': 'vertical'}
      Стена wall_window_6_top_27_to_32: bbox={'x': 1069.0, 'y': 588.0, 'width': 22.0, 'height': 45.0, 'orientation': 'vertical'}
      Стена wall_window_6_bottom_33_to_2: bbox={'x': 1069.0, 'y': 696.0, 'width': 22.0, 'height': 406.0, 'orientation': 'vertical'}
      Найдено 2 связанных проемов
    ✓ Стена wall_window_5_top_26_to_6: X 1069.0 -> 1069.0 (по проему window_6)
    ✓ Стена wall_window_5_bottom_32_to_27: X 1069.0 -> 1069.0 (по проему window_6)
    ✓ Стена wall_window_6_top_27_to_32: X 1069.0 -> 1069.0 (по проему window_6)
    ✓ Стена wall_window_6_bottom_33_to_2: X 1069.0 -> 1069.0 (по проему window_6)
    Группа на X=775.0: 3 стен
      Стена wall_door_3_top_30_to_-100030_edge: bbox={'x': 775.0, 'y': 717.9, 'width': 22.0, 'height': 94.10000000000002, 'orientation': 'vertical'}
      Стена wall_door_3_bottom_36_to_9: bbox={'x': 775.0, 'y': 902.0, 'width': 22.0, 'height': 74.0, 'orientation': 'vertical'}
      Стена wall_junction_4_to_9_up: bbox={'x': 776.0, 'y': 977.0, 'width': 22.0, 'height': 115.0, 'orientation': 'vertical'}
      Найдено 1 связанных проемов
    ✓ Стена wall_door_3_top_30_to_-100030_edge: X 775.0 -> 775.0 (по проему door_3)
    ✓ Стена wall_door_3_bottom_36_to_9: X 775.0 -> 775.0 (по проему door_3)
    ✓ Стена wall_junction_4_to_9_up: X 776.0 -> 775.0 (по проему door_3)
    Группа на X=603.0: 2 стен
      Стена wall_door_5_top_28_to_7: bbox={'x': 603.0, 'y': 606.0, 'width': 22.0, 'height': 51.0, 'orientation': 'vertical'}
      Стена wall_door_5_bottom_34_to_1: bbox={'x': 603.0, 'y': 727.0, 'width': 22.0, 'height': 83.0, 'orientation': 'vertical'}
      Найдено 1 связанных проемов
    ✓ Стена wall_door_5_top_28_to_7: X 603.0 -> 603.0 (по проему door_5)
    ✓ Стена wall_door_5_bottom_34_to_1: X 603.0 -> 603.0 (по проему door_5)
    Группа на X=405.0: 2 стен
      Стена wall_junction_8_to_12_down: bbox={'x': 405.0, 'y': 617.0, 'width': 22.0, 'height': 184.0, 'orientation': 'vertical'}
      Стена wall_junction_10_to_12_up: bbox={'x': 406.0, 'y': 801.0, 'width': 22.0, 'height': 174.0, 'orientation': 'vertical'}
      Найдено 0 связанных проемов
      Проемы не найдены, ищем полигоны стен для выравнивания...
      Количество стен в группе: 2
      Количество полигонов стен: 10
  Checking relationships for wall wall_junction_8_to_12_down
    DEBUG: Checking vertical wall at (416.0, 709.0)
      Found inside relationship with wall_polygon_7 (score: 100)
    Total relationships found: 1
  Checking relationships for wall wall_junction_10_to_12_up
    DEBUG: Checking vertical wall at (417.0, 888.0)
      Found inside relationship with wall_polygon_7 (score: 100)
    Total relationships found: 1
  Best polygon found: wall_polygon_7 with total score: 200
  Relationship details:
    wall_junction_8_to_12_down: inside (score: 100)
    wall_junction_10_to_12_up: inside (score: 100)
      Найден полигон для выравнивания: wall_polygon_7
    DEBUG: Checking vertical wall at (415.7, 709.0)
      Found inside relationship with wall_polygon_7 (score: 100)
    Total relationships found: 1
        Wall wall_junction_8_to_12_down: X 405.0 -> 404.7
    DEBUG: Checking vertical wall at (415.7, 888.0)
      Found inside relationship with wall_polygon_7 (score: 100)
    Total relationships found: 1
        Wall wall_junction_10_to_12_up: X 406.0 -> 404.7
  ✓ Выравнивание завершено
  ✓ Выравнивание применено к 24 сегментам из проемов и 5 сегментам из junctions
Сохранение данных в JSON: ./1_objects_wall_coordinates.json
  ✓ Данные успешно сохранены
Создание SVG из JSON: ./1_objects_wall_coordinates.json
  ✓ Отрисовка 10 стеновых полигонов
  ✓ Отрисовка 2 колонн как квадратов
  ✓ Используем толщину стены: 22.0 px
  ✓ Размер квадрата колонны: 53.31 px
    ✓ Колонна P1: центр(218.6, 1091.1) -> квадрат 53.31x53.31 px
    ✓ Колонна P2: центр(502.2, 1093.2) -> квадрат 53.31x53.31 px
  ✓ Отрисовка 7 окон и 5 дверей с толщиной 22.0 px
  ✓ Легенда добавлена
  ✓ Заголовок добавлен
  ✓ SVG сохранен: ./1_objects_wall_polygons.svg

============================================================
КОПИРОВАНИЕ ОБЪЕКТОВ OUTLINE, FOUNDATION И STREET В ОСНОВНОЙ JSON
============================================================
  ✓ Исходный файл загружен: 1_objects.json
  ✓ Основной JSON файл загружен: ./1_objects_wall_coordinates.json
  ✓ Foundation добавлен: foundation_1, 4 вершин
  ✓ Основной JSON файл обновлен: ./1_objects_wall_coordinates.json
  ✓ Копирование объектов завершено успешно

Готово! Векторная визуализация с измененной логикой расширения сегментов создана: ./1_objects_wall_polygons.svg
Данные координат сохранены в: ./1_objects_wall_coordinates.json
