# Руководство по использованию фильтрации MIN_AREA

## Обзор

Фильтрация по минимальной площади (`MIN_AREA`) позволяет исключать слишком мелкие объекты из результатов обнаружения штриховки. Это полезно для удаления шумов и мелких артефактов.

## Как это работает

- `MIN_AREA` определяет минимальную площадь компонента в пикселях
- Компоненты с площадью меньше `MIN_AREA` отфильтровываются (не включаются в результат)
- Компоненты с площадью больше или равной `MIN_AREA` сохраняются

## Рекомендуемые значения

| Значение | Описание | Результат |
|----------|----------|-----------|
| 2 | Минимальное значение, сохраняет практически все компоненты | ~609860 пикселей, 236 компонентов |
| 50 | Исключает очень мелкие компоненты | ~609625 пикселей, 230 компонентов |
| 500 | Исключает мелкие и средние компоненты | ~571489 пикселей, 76 компонентов |
| 1500 | Только крупные компоненты | Меньше пикселей, меньше компонентов |

## Использование в коде

### Способ 1: Изменение глобальной переменной

```python
# Измените значение в файле enhanced_hatching_fixed.py
MIN_AREA = 2  # или другое значение

# Запустите основной тест
python enhanced_hatching_fixed.py
```

### Способ 2: Передача параметра в функцию

```python
from enhanced_hatching_fixed import detect_hatching_enhanced_fixed

# Загрузка изображения
image = Image.open('plan_floor1.jpg').convert('RGB')
img_np = np.array(image)

# Использование с MIN_AREA = 2
wall_mask = detect_hatching_enhanced_fixed(
    img_np,
    min_area=2,
    max_area=None,
    min_rectangularity=None,
    min_neighbors=None
)
```

### Способ 3: Использование готовых тестовых функций

```python
# Запуск теста с MIN_AREA = 2
python test_min_area_2.py

# Запуск сравнительного теста
python test_min_area_fix.py
```

## Результаты тестирования

Сравнение результатов для разных значений MIN_AREA:

- MIN_AREA = 2: 609860 пикселей, 236 компонентов (размеры от 26 до 158982)
- MIN_AREA = 50: 609625 пикселей, 230 компонентов (размеры от 60 до 158982)
- MIN_AREA = 500: 571489 пикселей, 76 компонентов (размеры от 511 до 158982)

## Советы

1. Начните с малого значения (2-50) и постепенно увеличивайте, если нужно отфильтровать шум
2. Используйте `test_min_area_fix.py` для сравнения результатов с разными значениями
3. Комбинируйте с другими фильтрами (например, `min_rectangularity`) для более точной фильтрации
4. Проверяйте визуальные результаты в сохраненных файлах PNG

## Файлы результатов

- `enhanced_hatching_strict_mask.png` - основной результат с текущими настройками
- `min_area_2_result.png` - результат с MIN_AREA = 2
- `test_min_area_2.png`, `test_min_area_50.png`, `test_min_area_500.png` - сравнительные результаты