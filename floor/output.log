============================================================
СОЗДАНИЕ ВЕКТОРНОЙ ВИЗУАЛИЗАЦИИ НА ОСНОВЕ ПРОЕМОВ С АНАЛИЗОМ ТИПОВ JUNCTIONS
============================================================
  ✓ Данные загружены из plan_floor1_objects.json
  ✓ Толщина стен определена как 22.0 px (минимальная толщина двери)

============================================================
ОБРАБОТКА ПРОЕМОВ С УЧЕТОМ JUNCTIONS
============================================================
  ✓ Загружено 39 junctions
Обработка 13 проемов:
  Вызов construct_wall_segment_from_opening для проема window_2
    DEBUG: Обработка проема window_2, ориентация: horizontal
    Сдвигаем край проема window_2 до junction 14 в направлении left
    Проем window_2 изменен: {'x': 286.0, 'y': 139.0, 'width': 156.0, 'height': 22.0} -> {'x': 287.0, 'y': 139.0, 'width': 155.0, 'height': 22.0}
    DEBUG: После сдвига края проема window_2, bbox={'x': 287.0, 'y': 139.0, 'width': 155.0, 'height': 22.0}
    DEBUG: Проверка проема window_2 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    Сдвигаем край проема window_2 до junction 23 в направлении right
    Проем window_2 изменен: {'x': 287.0, 'y': 139.0, 'width': 155.0, 'height': 22.0} -> {'x': 287.0, 'y': 139.0, 'width': 155.0, 'height': 22.0}
    DEBUG: После сдвига края проема window_2, bbox={'x': 287.0, 'y': 139.0, 'width': 155.0, 'height': 22.0}
    DEBUG: Проверка проема window_2 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_2 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_4
    DEBUG: Обработка проема window_4, ориентация: horizontal
    Сдвигаем край проема window_4 до junction 16 в направлении left
    Проем window_4 изменен: {'x': 622.0, 'y': 139.0, 'width': 97.0, 'height': 22.0} -> {'x': 623.0, 'y': 139.0, 'width': 96.0, 'height': 22.0}
    DEBUG: После сдвига края проема window_4, bbox={'x': 623.0, 'y': 139.0, 'width': 96.0, 'height': 22.0}
    DEBUG: Проверка проема window_4 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    Сдвигаем край проема window_4 до junction 15 в направлении right
    Проем window_4 изменен: {'x': 623.0, 'y': 139.0, 'width': 96.0, 'height': 22.0} -> {'x': 623.0, 'y': 139.0, 'width': 95.0, 'height': 22.0}
    DEBUG: После сдвига края проема window_4, bbox={'x': 623.0, 'y': 139.0, 'width': 95.0, 'height': 22.0}
    После сдвига края найден соседний проем door_2, стена не создается
  ✓ Проем window_4 (horizontal): 1 сегментов
  Вызов construct_wall_segment_from_opening для проема door_2
    DEBUG: Обработка проема door_2, ориентация: horizontal
    Сдвигаем край проема door_2 до junction 15 в направлении left
    Проем door_2 изменен: {'x': 720.0, 'y': 139.0, 'width': 87.0, 'height': 22.0} -> {'x': 718.0, 'y': 139.0, 'width': 89.0, 'height': 22.0}
    DEBUG: После сдвига края проема door_2, bbox={'x': 718.0, 'y': 139.0, 'width': 89.0, 'height': 22.0}
    После сдвига края найден соседний проем window_4, стена не создается
    Сдвигаем край проема door_2 до junction 22 в направлении right
    Проем door_2 изменен: {'x': 718.0, 'y': 139.0, 'width': 89.0, 'height': 22.0} -> {'x': 718.0, 'y': 139.0, 'width': 88.0, 'height': 22.0}
    DEBUG: После сдвига края проема door_2, bbox={'x': 718.0, 'y': 139.0, 'width': 88.0, 'height': 22.0}
    DEBUG: Проверка проема door_2 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_2 (horizontal): 1 сегментов
  Вызов construct_wall_segment_from_opening для проема door_1
    DEBUG: Обработка проема door_1, ориентация: horizontal
    Сдвигаем край проема door_1 до junction 19 в направлении left
    Проем door_1 изменен: {'x': 624.0, 'y': 966.5, 'width': 131.0, 'height': 22.0} -> {'x': 623.0, 'y': 966.5, 'width': 132.0, 'height': 22.0}
    DEBUG: После сдвига края проема door_1, bbox={'x': 623.0, 'y': 966.5, 'width': 132.0, 'height': 22.0}
    DEBUG: Проверка проема door_1 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    Сдвигаем край проема door_1 до junction 26 в направлении right
    Проем door_1 изменен: {'x': 623.0, 'y': 966.5, 'width': 132.0, 'height': 22.0} -> {'x': 623.0, 'y': 966.5, 'width': 131.0, 'height': 22.0}
    DEBUG: После сдвига края проема door_1, bbox={'x': 623.0, 'y': 966.5, 'width': 131.0, 'height': 22.0}
    DEBUG: Проверка проема door_1 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_1 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема door_3
    DEBUG: Обработка проема door_3, ориентация: horizontal
    Сдвигаем край проема door_3 до junction 18 в направлении left
    Проем door_3 изменен: {'x': 277.0, 'y': 966.5, 'width': 92.0, 'height': 22.0} -> {'x': 278.0, 'y': 966.5, 'width': 91.0, 'height': 22.0}
    DEBUG: После сдвига края проема door_3, bbox={'x': 278.0, 'y': 966.5, 'width': 91.0, 'height': 22.0}
    DEBUG: Проверка проема door_3 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    Сдвигаем край проема door_3 до junction 25 в направлении right
    Проем door_3 изменен: {'x': 278.0, 'y': 966.5, 'width': 91.0, 'height': 22.0} -> {'x': 278.0, 'y': 966.5, 'width': 90.0, 'height': 22.0}
    DEBUG: После сдвига края проема door_3, bbox={'x': 278.0, 'y': 966.5, 'width': 90.0, 'height': 22.0}
    DEBUG: Проверка проема door_3 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_3 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_3
    DEBUG: Обработка проема window_3, ориентация: vertical
    Сдвигаем край проема window_3 до junction 28 в направлении up
    Проем window_3 изменен: {'x': 204.5, 'y': 220.0, 'width': 22.0, 'height': 155.0} -> {'x': 204.5, 'y': 220.0, 'width': 22.0, 'height': 155.0}
    DEBUG: После сдвига края проема window_3, bbox={'x': 204.5, 'y': 220.0, 'width': 22.0, 'height': 155.0}
    DEBUG: Проверка проема window_3 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    Сдвигаем край проема window_3 до junction 34 в направлении down
    Проем window_3 изменен: {'x': 204.5, 'y': 220.0, 'width': 22.0, 'height': 155.0} -> {'x': 204.5, 'y': 220.0, 'width': 22.0, 'height': 155.0}
    DEBUG: После сдвига края проема window_3, bbox={'x': 204.5, 'y': 220.0, 'width': 22.0, 'height': 155.0}
    DEBUG: Проверка проема window_3 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_3 (vertical): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_5
    DEBUG: Обработка проема window_5, ориентация: vertical
    Сдвигаем край проема window_5 до junction 32 в направлении up
    Проем window_5 изменен: {'x': 204.5, 'y': 676.0, 'width': 22.0, 'height': 63.0} -> {'x': 204.5, 'y': 677.0, 'width': 22.0, 'height': 62.0}
    DEBUG: После сдвига края проема window_5, bbox={'x': 204.5, 'y': 677.0, 'width': 22.0, 'height': 62.0}
    DEBUG: Проверка проема window_5 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    Сдвигаем край проема window_5 до junction 38 в направлении down
    Проем window_5 изменен: {'x': 204.5, 'y': 677.0, 'width': 22.0, 'height': 62.0} -> {'x': 204.5, 'y': 677.0, 'width': 22.0, 'height': 61.0}
    DEBUG: После сдвига края проема window_5, bbox={'x': 204.5, 'y': 677.0, 'width': 22.0, 'height': 61.0}
    DEBUG: Проверка проема window_5 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_5 (vertical): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_6
    DEBUG: Обработка проема window_6, ориентация: vertical
    Сдвигаем край проема window_6 до junction 29 в направлении up
    Проем window_6 изменен: {'x': 1069.0, 'y': 524.0, 'width': 22.0, 'height': 64.0} -> {'x': 1069.0, 'y': 525.0, 'width': 22.0, 'height': 63.0}
    DEBUG: После сдвига края проема window_6, bbox={'x': 1069.0, 'y': 525.0, 'width': 22.0, 'height': 63.0}
    DEBUG: Проверка проема window_6 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    Сдвигаем край проема window_6 до junction 35 в направлении down
    Проем window_6 изменен: {'x': 1069.0, 'y': 525.0, 'width': 22.0, 'height': 63.0} -> {'x': 1069.0, 'y': 525.0, 'width': 22.0, 'height': 63.0}
    DEBUG: После сдвига края проема window_6, bbox={'x': 1069.0, 'y': 525.0, 'width': 22.0, 'height': 63.0}
    DEBUG: Проверка проема window_6 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_6 (vertical): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_7
    DEBUG: Обработка проема window_7, ориентация: vertical
    Сдвигаем край проема window_7 до junction 30 в направлении up
    Проем window_7 изменен: {'x': 1069.0, 'y': 633.0, 'width': 22.0, 'height': 62.0} -> {'x': 1069.0, 'y': 633.0, 'width': 22.0, 'height': 62.0}
    DEBUG: После сдвига края проема window_7, bbox={'x': 1069.0, 'y': 633.0, 'width': 22.0, 'height': 62.0}
    DEBUG: Проверка проема window_7 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    Сдвигаем край проема window_7 до junction 36 в направлении down
    Проем window_7 изменен: {'x': 1069.0, 'y': 633.0, 'width': 22.0, 'height': 62.0} -> {'x': 1069.0, 'y': 633.0, 'width': 22.0, 'height': 63.0}
    DEBUG: После сдвига края проема window_7, bbox={'x': 1069.0, 'y': 633.0, 'width': 22.0, 'height': 63.0}
    DEBUG: Проверка проема window_7 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_7 (vertical): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_1
    DEBUG: Обработка проема window_1, ориентация: horizontal
    Сдвигаем край проема window_1 до junction 20 в направлении left
    Проем window_1 изменен: {'x': 820.0, 'y': 1081.0, 'width': 227.0, 'height': 22.0} -> {'x': 821.0, 'y': 1081.0, 'width': 226.0, 'height': 22.0}
    DEBUG: После сдвига края проема window_1, bbox={'x': 821.0, 'y': 1081.0, 'width': 226.0, 'height': 22.0}
    DEBUG: Проверка проема window_1 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    Сдвигаем край проема window_1 до junction 27 в направлении right
    Проем window_1 изменен: {'x': 821.0, 'y': 1081.0, 'width': 226.0, 'height': 22.0} -> {'x': 821.0, 'y': 1081.0, 'width': 225.0, 'height': 22.0}
    DEBUG: После сдвига края проема window_1, bbox={'x': 821.0, 'y': 1081.0, 'width': 225.0, 'height': 22.0}
    DEBUG: Проверка проема window_1 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_1 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема door_4
    DEBUG: Обработка проема door_4, ориентация: vertical
    Сдвигаем край проема door_4 до junction 33 в направлении up
    Проем door_4 изменен: {'x': 774.5, 'y': 812.0, 'width': 22.0, 'height': 91.0} -> {'x': 774.5, 'y': 812.0, 'width': 22.0, 'height': 91.0}
    DEBUG: После сдвига края проема door_4, bbox={'x': 774.5, 'y': 812.0, 'width': 22.0, 'height': 91.0}
    DEBUG: Проверка проема door_4 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    Сдвигаем край проема door_4 до junction 39 в направлении down
    Проем door_4 изменен: {'x': 774.5, 'y': 812.0, 'width': 22.0, 'height': 91.0} -> {'x': 774.5, 'y': 812.0, 'width': 22.0, 'height': 91.0}
    DEBUG: После сдвига края проема door_4, bbox={'x': 774.5, 'y': 812.0, 'width': 22.0, 'height': 91.0}
    DEBUG: Проверка проема door_4 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_4 (vertical): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема door_5
    DEBUG: Обработка проема door_5, ориентация: horizontal
    Сдвигаем край проема door_5 до junction 17 в направлении left
    Проем door_5 изменен: {'x': 278.0, 'y': 605.0, 'width': 70.0, 'height': 22.0} -> {'x': 280.0, 'y': 605.0, 'width': 68.0, 'height': 22.0}
    DEBUG: После сдвига края проема door_5, bbox={'x': 280.0, 'y': 605.0, 'width': 68.0, 'height': 22.0}
    DEBUG: Проверка проема door_5 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    Сдвигаем край проема door_5 до junction 24 в направлении right
    Проем door_5 изменен: {'x': 280.0, 'y': 605.0, 'width': 68.0, 'height': 22.0} -> {'x': 280.0, 'y': 605.0, 'width': 68.0, 'height': 22.0}
    DEBUG: После сдвига края проема door_5, bbox={'x': 280.0, 'y': 605.0, 'width': 68.0, 'height': 22.0}
    DEBUG: Проверка проема door_5 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_5 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема door_6
    DEBUG: Обработка проема door_6, ориентация: vertical
    Сдвигаем край проема door_6 до junction 31 в направлении up
    Проем door_6 изменен: {'x': 603.5, 'y': 657.0, 'width': 22.0, 'height': 71.0} -> {'x': 603.5, 'y': 657.0, 'width': 22.0, 'height': 71.0}
    DEBUG: После сдвига края проема door_6, bbox={'x': 603.5, 'y': 657.0, 'width': 22.0, 'height': 71.0}
    DEBUG: Проверка проема door_6 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    Сдвигаем край проема door_6 до junction 37 в направлении down
    Проем door_6 изменен: {'x': 603.5, 'y': 657.0, 'width': 22.0, 'height': 71.0} -> {'x': 603.5, 'y': 657.0, 'width': 22.0, 'height': 70.0}
    DEBUG: После сдвига края проема door_6, bbox={'x': 603.5, 'y': 657.0, 'width': 22.0, 'height': 70.0}
    DEBUG: Проверка проема door_6 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_6 (vertical): 2 сегментов

Всего создано 24 сегментов стен из 13 проемов

============================================================
ОБРАБОТКА КОЛОНН И СОЗДАНИЕ КВАДРАТОВ
============================================================
  Найдено 2 полигонов колонн
  Найдено 2 колонн
  Используем только pillar_polygons для избежания дублирования
  ✓ Создан квадрат для колонны P1: центр(217.1, 1091.6), размер 22.0x22.0
  ✓ Создан квадрат для колонны P2: центр(503.0, 1091.2), размер 22.0x22.0

  ✓ Всего создано квадратов колонн: 2

============================================================
АНАЛИЗ ТИПОВ JUNCTIONS С УЛУЧШЕННОЙ ЛОГИКОЙ
============================================================
  ✓ Загружено 39 junctions
Анализ типов 39 junctions с улучшенной логикой...
  Junction 1 (780.0, 618.0): тип=unknown (не внутри полигона)
  Junction 2 (614.0, 799.0): тип=L, направления=left, up
  Junction 3 (1081.0, 1092.0): тип=L, направления=left, up
  Junction 4 (215.0, 975.0): тип=L, направления=right, up
  Junction 5 (787.0, 1092.0): тип=L, направления=right, up
  Junction 6 (215.0, 151.0): тип=L, направления=right, down
  Junction 7 (1081.0, 150.0): тип=L, направления=left, down
  Junction 8 (615.0, 617.0): тип=L, направления=left, down
  Junction 9 (414.0, 618.0): тип=T, направления=left, right, down
  Junction 10 (787.0, 977.0): тип=L, направления=left, down
  Junction 11 (417.0, 975.0): тип=T, направления=left, right, up
  Junction 12 (215.0, 616.0): тип=L, направления=right, up
  Junction 13 (415.0, 800.0): тип=T, направления=right, up, down
  Junction 14 (287.0, 150.0): тип=unknown, направления=left
  Junction 15 (718.0, 150.0): тип=unknown (не внутри полигона)
  Junction 16 (623.0, 151.0): тип=unknown (не внутри полигона)
  Junction 17 (280.0, 616.0): тип=unknown (не внутри полигона)
  Junction 18 (278.0, 978.0): тип=T, направления=left, right, down
  Junction 19 (623.0, 978.0): тип=unknown (не внутри полигона)
  Junction 20 (821.0, 1090.0): тип=unknown, направления=left
  Junction 21 (716.0, 150.0): тип=unknown (не внутри полигона)
  Junction 22 (806.0, 150.0): тип=unknown, направления=right
  Junction 23 (442.0, 151.0): тип=unknown, направления=right
  Junction 24 (348.0, 617.0): тип=unknown (не внутри полигона)
  Junction 25 (368.0, 976.0): тип=unknown (не внутри полигона)
  Junction 26 (754.0, 976.0): тип=unknown (не внутри полигона)
  Junction 27 (1046.0, 1091.0): тип=unknown (не внутри полигона)
  Junction 28 (216.0, 220.0): тип=unknown, направления=up
  Junction 29 (1081.0, 525.0): тип=unknown (не внутри полигона)
  Junction 30 (1081.0, 633.0): тип=unknown (не внутри полигона)
  Junction 31 (615.0, 657.0): тип=unknown, направления=up
  Junction 32 (216.0, 677.0): тип=unknown (не внутри полигона)
  Junction 33 (786.0, 812.0): тип=unknown (не внутри полигона)
  Junction 34 (216.0, 375.0): тип=unknown, направления=down
  Junction 35 (1080.0, 588.0): тип=unknown (не внутри полигона)
  Junction 36 (1080.0, 696.0): тип=unknown (не внутри полигона)
  Junction 37 (616.0, 727.0): тип=unknown (не внутри полигона)
  Junction 38 (216.0, 738.0): тип=unknown (не внутри полигона)
  Junction 39 (786.0, 903.0): тип=unknown, направления=down

Статистика типов junctions:
  unknown: 26
  L: 9
  T: 4

============================================================
ПОИСК JUNCTIONS НЕ СВЯЗАННЫХ С ПРОЕМАМИ И ДОСТРАИВАНИЕ СТЕН
============================================================

--- Итерация 1 ---
  ✓ Найдено 9 junctions для обработки
  Обработка junction 2...
  Junction 2: существующие направления=['up'], требуемые=['left', 'up'], недостающие=['left']
    ✓ Создан сегмент от J2 до J13 в направлении left

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J2 до J13
  ✓ Создано 1 новых уникальных сегментов для junction 2

--- Итерация 2 ---
  ✓ Найдено 8 junctions для обработки
  Обработка junction 5...
  Junction 5: существующие направления=['right'], требуемые=['right', 'up'], недостающие=['up']
    ✓ Создан сегмент от J5 до J10 в направлении up

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J5 до J10
  ✓ Создано 1 новых уникальных сегментов для junction 5

--- Итерация 3 ---
  ✓ Найдено 7 junctions для обработки
  Обработка junction 8...
  Junction 8: существующие направления=['down'], требуемые=['left', 'down'], недостающие=['left']
    ✓ Создан сегмент от J8 до J9 в направлении left

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J8 до J9
  ✓ Создано 1 новых уникальных сегментов для junction 8

--- Итерация 4 ---
  ✓ Найдено 6 junctions для обработки
  Обработка junction 9...
  Junction 9: существующие направления=['left', 'right'], требуемые=['left', 'right', 'down'], недостающие=['down']
    ✓ Создан сегмент от J9 до J13 в направлении down

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J9 до J13
  ✓ Создано 1 новых уникальных сегментов для junction 9

--- Итерация 5 ---
  ✓ Найдено 5 junctions для обработки
  Обработка junction 11...
  Junction 11: существующие направления=['left', 'right'], требуемые=['left', 'right', 'up'], недостающие=['up']
    ✓ Создан сегмент от J11 до J13 в направлении up

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J11 до J13
  ✓ Создано 1 новых уникальных сегментов для junction 11

============================================================
ОБРАБОТКА L-JUNCTIONS И РАСШИРЕНИЕ ОРИГИНАЛЬНЫХ СЕГМЕНТОВ
============================================================
  ✓ Найдено 9 L-junctions
  Обработка L-junction 2 (614.0, 799.0)
    ✓ Выбран сегмент для расширения: wall_door_6_bottom_37_to_2
    ✓ Оригинальные границы segment bbox: {'x': 603.5, 'y': 727.0, 'width': 22.0, 'height': 71.0, 'orientation': 'vertical'}
    → Шаг 1: Расширение до границы полигона...
    ✓ Выбран перпендикулярный сегмент: wall_junction_2_to_13_left
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Сегмент wall_door_6_bottom_37_to_2 расширен вниз до 810.0
    ✓ После расширения до перпендикуляра: {'x': 603.5, 'y': 727.0, 'width': 22.0, 'height': 83.0, 'orientation': 'vertical'}
    ✓ Итог: Сегмент wall_door_6_bottom_37_to_2 расширен
      оригинал: {'x': 603.5, 'y': 727.0, 'width': 22.0, 'height': 71.0, 'orientation': 'vertical'}
      результат: {'x': 603.5, 'y': 727.0, 'width': 22.0, 'height': 83.0, 'orientation': 'vertical'}
  Обработка L-junction 3 (1081.0, 1092.0)
    ✓ Выбран сегмент для расширения: wall_window_7_bottom_36_to_3
    ✓ Оригинальные границы segment bbox: {'x': 1069.0, 'y': 696.0, 'width': 22.0, 'height': 397.0, 'orientation': 'vertical'}
    → Шаг 1: Расширение до границы полигона...
    ✓ Выбран перпендикулярный сегмент: wall_window_1_right_27_to_3
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Сегмент wall_window_7_bottom_36_to_3 расширен вниз до 1103.0
    ✓ После расширения до перпендикуляра: {'x': 1069.0, 'y': 696.0, 'width': 22.0, 'height': 407.0, 'orientation': 'vertical'}
    ✓ Итог: Сегмент wall_window_7_bottom_36_to_3 расширен
      оригинал: {'x': 1069.0, 'y': 696.0, 'width': 22.0, 'height': 397.0, 'orientation': 'vertical'}
      результат: {'x': 1069.0, 'y': 696.0, 'width': 22.0, 'height': 407.0, 'orientation': 'vertical'}
  Обработка L-junction 4 (215.0, 975.0)
    ✓ Выбран сегмент для расширения: wall_door_3_left_18_to_4
    ✓ Оригинальные границы segment bbox: {'x': 215.0, 'y': 966.5, 'width': 63.0, 'height': 22.0, 'orientation': 'horizontal'}
    → Шаг 1: Расширение до границы полигона...
    ✓ Сегмент wall_door_3_left_18_to_4 расширен вправо до 279.0
    ✓ После расширения до границы полигона: {'x': 215.0, 'y': 966.5, 'width': 64.0, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Выбран перпендикулярный сегмент: wall_window_5_bottom_38_to_4
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Сегмент wall_door_3_left_18_to_4 расширен влево до 204.5
    ✓ После расширения до перпендикуляра: {'x': 204.5, 'y': 966.5, 'width': 74.5, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_door_3_left_18_to_4 расширен
      оригинал: {'x': 215.0, 'y': 966.5, 'width': 63.0, 'height': 22.0, 'orientation': 'horizontal'}
      результат: {'x': 204.5, 'y': 966.5, 'width': 74.5, 'height': 22.0, 'orientation': 'horizontal'}
  Обработка L-junction 5 (787.0, 1092.0)
    ✓ Выбран сегмент для расширения: wall_window_1_left_20_to_5
    ✓ Оригинальные границы segment bbox: {'x': 787.0, 'y': 1081.0, 'width': 34.0, 'height': 22.0, 'orientation': 'horizontal'}
    → Шаг 1: Расширение до границы полигона...
    ✓ Сегмент wall_window_1_left_20_to_5 расширен вправо до 821.125
    ✓ После расширения до границы полигона: {'x': 787.0, 'y': 1081.0, 'width': 34.125, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Выбран перпендикулярный сегмент: wall_junction_5_to_10_up
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Сегмент wall_window_1_left_20_to_5 расширен влево до 776.0
    ✓ После расширения до перпендикуляра: {'x': 776.0, 'y': 1081.0, 'width': 45.125, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_window_1_left_20_to_5 расширен
      оригинал: {'x': 787.0, 'y': 1081.0, 'width': 34.0, 'height': 22.0, 'orientation': 'horizontal'}
      результат: {'x': 776.0, 'y': 1081.0, 'width': 45.125, 'height': 22.0, 'orientation': 'horizontal'}
  Обработка L-junction 6 (215.0, 151.0)
    ✓ Выбран сегмент для расширения: wall_window_2_left_14_to_6
    ✓ Оригинальные границы segment bbox: {'x': 215.0, 'y': 139.0, 'width': 72.0, 'height': 22.0, 'orientation': 'horizontal'}
    → Шаг 1: Расширение до границы полигона...
    ✓ Сегмент wall_window_2_left_14_to_6 расширен вправо до 287.3333333333333
    ✓ После расширения до границы полигона: {'x': 215.0, 'y': 139.0, 'width': 72.33333333333331, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Выбран перпендикулярный сегмент: wall_window_3_top_28_to_6
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Сегмент wall_window_2_left_14_to_6 расширен влево до 204.5
    ✓ После расширения до перпендикуляра: {'x': 204.5, 'y': 139.0, 'width': 82.83333333333331, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_window_2_left_14_to_6 расширен
      оригинал: {'x': 215.0, 'y': 139.0, 'width': 72.0, 'height': 22.0, 'orientation': 'horizontal'}
      результат: {'x': 204.5, 'y': 139.0, 'width': 82.83333333333331, 'height': 22.0, 'orientation': 'horizontal'}
  Обработка L-junction 7 (1081.0, 150.0)
    ✓ Выбран сегмент для расширения: wall_door_2_right_22_to_7
    ✓ Оригинальные границы segment bbox: {'x': 806.0, 'y': 139.0, 'width': 275.0, 'height': 22.0, 'orientation': 'horizontal'}
    → Шаг 1: Расширение до границы полигона...
    ✗ Сегмент wall_door_2_right_22_to_7 является стеной от проема, не расширяем влево
    ✓ Выбран перпендикулярный сегмент: wall_window_6_top_29_to_7
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Сегмент wall_door_2_right_22_to_7 расширен вправо до 1091.0
    ✓ После расширения до перпендикуляра: {'x': 806.0, 'y': 139.0, 'width': 285.0, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_door_2_right_22_to_7 расширен
      оригинал: {'x': 806.0, 'y': 139.0, 'width': 275.0, 'height': 22.0, 'orientation': 'horizontal'}
      результат: {'x': 806.0, 'y': 139.0, 'width': 285.0, 'height': 22.0, 'orientation': 'horizontal'}
  Обработка L-junction 8 (615.0, 617.0)
    ✓ Выбран сегмент для расширения: wall_door_6_top_31_to_8
    ✓ Оригинальные границы segment bbox: {'x': 603.5, 'y': 617.0, 'width': 22.0, 'height': 40.0, 'orientation': 'vertical'}
    → Шаг 1: Расширение до границы полигона...
    ✓ Выбран перпендикулярный сегмент: wall_junction_8_to_9_left
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Сегмент wall_door_6_top_31_to_8 расширен вверх до 606.0
    ✓ После расширения до перпендикуляра: {'x': 603.5, 'y': 606.0, 'width': 22.0, 'height': 51.0, 'orientation': 'vertical'}
    ✓ Итог: Сегмент wall_door_6_top_31_to_8 расширен
      оригинал: {'x': 603.5, 'y': 617.0, 'width': 22.0, 'height': 40.0, 'orientation': 'vertical'}
      результат: {'x': 603.5, 'y': 606.0, 'width': 22.0, 'height': 51.0, 'orientation': 'vertical'}
  Обработка L-junction 10 (787.0, 977.0)
    ✓ Выбран сегмент для расширения: wall_door_1_right_26_to_10
    ✓ Оригинальные границы segment bbox: {'x': 754.0, 'y': 966.5, 'width': 33.0, 'height': 22.0, 'orientation': 'horizontal'}
    → Шаг 1: Расширение до границы полигона...
    DEBUG J10: extend_segment_to_polygon_edge called for wall_door_1_right_26_to_10
    DEBUG J10: segment bbox before={'x': 754.0, 'y': 966.5, 'width': 33.0, 'height': 22.0, 'orientation': 'horizontal'}
    DEBUG J10: junction directions=['left', 'down']
    DEBUG J10: extend_direction=left
    DEBUG J10: intersections={'left': 756.0, 'right': 798.0, 'up': 958.1111111111111, 'down': 1102.0}
    ✗ Сегмент wall_door_1_right_26_to_10 является стеной от проема, не расширяем влево
    ✓ Выбран перпендикулярный сегмент: wall_door_4_bottom_39_to_10
    → Шаг 2: Расширение до перпендикулярного сегмента...
    DEBUG J10: segment=wall_door_1_right_26_to_10, perpendicular=wall_door_4_bottom_39_to_10
    DEBUG J10: segment bbox={'x': 754.0, 'y': 966.5, 'width': 33.0, 'height': 22.0, 'orientation': 'horizontal'}
    DEBUG J10: perpendicular bbox={'x': 774.5, 'y': 903.0, 'width': 22.0, 'height': 74.0, 'orientation': 'vertical'}
    ✓ Сегмент wall_door_1_right_26_to_10 расширен вправо до 796.5
    DEBUG J10: bbox changed from {'x': 754.0, 'y': 966.5, 'width': 33.0, 'height': 22.0, 'orientation': 'horizontal'} to {'x': 754.0, 'y': 966.5, 'width': 42.5, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ После расширения до перпендикуляра: {'x': 754.0, 'y': 966.5, 'width': 42.5, 'height': 22.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_door_1_right_26_to_10 расширен
      оригинал: {'x': 754.0, 'y': 966.5, 'width': 33.0, 'height': 22.0, 'orientation': 'horizontal'}
      результат: {'x': 754.0, 'y': 966.5, 'width': 42.5, 'height': 22.0, 'orientation': 'horizontal'}
  Обработка L-junction 12 (215.0, 616.0)
    ✓ Выбран сегмент для расширения: wall_window_3_bottom_34_to_12
    ✓ Оригинальные границы segment bbox: {'x': 204.5, 'y': 375.0, 'width': 22.0, 'height': 241.0, 'orientation': 'vertical'}
    → Шаг 1: Расширение до границы полигона...
    ✓ Выбран перпендикулярный сегмент: wall_window_5_top_32_to_12
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✗ Сегмент wall_window_3_bottom_34_to_12 не был расширен
  ✓ Расширено 11 сегментов для L-junctions

============================================================
ОБНОВЛЕНИЕ JSON ДАННЫХ С РАСШИРЕННЫМИ СЕГМЕНТАМИ
============================================================
  ✓ Обновлен сегмент из проема: wall_window_2_left_14_to_6
  ✓ Обновлен сегмент из проема: wall_window_2_right_23_to_16
  ✓ Обновлен сегмент из проема: wall_window_4_left_16_to_23
  ✓ Обновлен сегмент из проема: wall_door_2_right_22_to_7
  ✓ Обновлен сегмент из проема: wall_door_1_left_19_to_11
  ✓ Обновлен сегмент из проема: wall_door_1_right_26_to_10
  ✓ Обновлен сегмент из проема: wall_door_3_left_18_to_4
  ✓ Обновлен сегмент из проема: wall_door_3_right_25_to_11
  ✓ Обновлен сегмент из проема: wall_window_3_top_28_to_6
  ✓ Обновлен сегмент из проема: wall_window_3_bottom_34_to_12
  ✓ Обновлен сегмент из проема: wall_window_5_top_32_to_12
  ✓ Обновлен сегмент из проема: wall_window_5_bottom_38_to_4
  ✓ Обновлен сегмент из проема: wall_window_6_top_29_to_7
  ✓ Обновлен сегмент из проема: wall_window_6_bottom_35_to_30
  ✓ Обновлен сегмент из проема: wall_window_7_top_30_to_35
  ✓ Обновлен сегмент из проема: wall_window_7_bottom_36_to_3
  ✓ Обновлен сегмент из проема: wall_window_1_left_20_to_5
  ✓ Обновлен сегмент из проема: wall_window_1_right_27_to_3
  ✓ Обновлен сегмент из проема: wall_door_4_top_33_to_1
  ✓ Обновлен сегмент из проема: wall_door_4_bottom_39_to_10
  ✓ Обновлен сегмент из проема: wall_door_5_left_17_to_12
  ✓ Обновлен сегмент из проема: wall_door_5_right_24_to_9
  ✓ Обновлен сегмент из проема: wall_door_6_top_31_to_8
  ✓ Обновлен сегмент из проема: wall_door_6_bottom_37_to_2
  ✓ Обновлен сегмент из junction: wall_junction_2_to_13_left
  ✓ Обновлен сегмент из junction: wall_junction_5_to_10_up
  ✓ Обновлен сегмент из junction: wall_junction_8_to_9_left
  ✓ Обновлен сегмент из junction: wall_junction_9_to_13_down
  ✓ Обновлен сегмент из junction: wall_junction_11_to_13_up
  ✓ JSON данные обновлены с 11 расширенными сегментами

============================================================
ДОБАВЛЕНИЕ ПРИВЯЗОК JUNCTIONS К СТЕНАМ
============================================================
