============================================================
СОЗДАНИЕ ВЕКТОРНОЙ ВИЗУАЛИЗАЦИИ НА ОСНОВЕ ПРОЕМОВ С АНАЛИЗОМ ТИПОВ JUNCTIONS
============================================================
Загрузка данных из: 2_objects.json
  ✓ Данные успешно загружены
  ✓ Толщина стен определена по минимальной толщине дверей: 21.0 px

============================================================
ОБРАБОТКА ПРОЕМОВ С УЧЕТОМ JUNCTIONS
============================================================
  ✓ Загружено 61 junctions
Обработка 13 проемов:
  Вызов construct_wall_segment_from_opening для проема window_2
    DEBUG: Обработка проема window_2, ориентация: horizontal
    DEBUG: Проверка проема window_2 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема window_2 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_2 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_3
    DEBUG: Обработка проема window_3, ориентация: horizontal
    DEBUG: Проверка проема window_3 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема window_3 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_3 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_4
    DEBUG: Обработка проема window_4, ориентация: horizontal
    DEBUG: Проверка проема window_4 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема window_4 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_4 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_5
    DEBUG: Обработка проема window_5, ориентация: horizontal
    DEBUG: Проверка проема window_5 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема window_5 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_5 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_6
    DEBUG: Обработка проема window_6, ориентация: vertical
    DEBUG: Проверка проема window_6 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема window_6 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_6 (vertical): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_7
    DEBUG: Обработка проема window_7, ориентация: vertical
    DEBUG: Проверка проема window_7 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема window_7 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_7 (vertical): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема door_1
    DEBUG: Обработка проема door_1, ориентация: vertical
    DEBUG: Проверка проема door_1 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема door_1 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_1 (vertical): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема door_4
    DEBUG: Обработка проема door_4, ориентация: vertical
    DEBUG: Проверка проема door_4 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема door_4 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_4 (vertical): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_1
    DEBUG: Обработка проема window_1, ориентация: horizontal
    DEBUG: Проверка проема window_1 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема window_1 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_1 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема window_8
    DEBUG: Обработка проема window_8, ориентация: vertical
    DEBUG: Проверка проема window_8 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема window_8 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем window_8 (vertical): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема door_2
    DEBUG: Обработка проема door_2, ориентация: horizontal
    DEBUG: Проверка проема door_2 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема door_2 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_2 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема door_3
    DEBUG: Обработка проема door_3, ориентация: horizontal
    DEBUG: Проверка проема door_3 в направлении left, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема door_3 в направлении right, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_3 (horizontal): 2 сегментов
  Вызов construct_wall_segment_from_opening для проема door_5
    DEBUG: Обработка проема door_5, ориентация: vertical
    DEBUG: Проверка проема door_5 в направлении up, найден соседний проем: None
    Соседний проем не найден, создаем стену
    DEBUG: Проверка проема door_5 в направлении down, найден соседний проем: None
    Соседний проем не найден, создаем стену
  ✓ Проем door_5 (vertical): 2 сегментов

Всего создано 26 сегментов стен из 13 проемов

============================================================
ОБРАБОТКА КОЛОНН И СОЗДАНИЕ КВАДРАТОВ
============================================================
  Найдено 0 полигонов колонн
  Найдено 0 колонн
  Используем только pillar_polygons для избежания дублирования

  ✓ Всего создано квадратов колонн: 0

============================================================
АНАЛИЗ ТИПОВ JUNCTIONS С УЛУЧШЕННОЙ ЛОГИКОЙ
============================================================
  ✓ Загружено 61 junctions
Анализ типов 61 junctions с улучшенной логикой...
  Junction 1 (721.0, 723.0): тип=unknown, направления=up
  Junction 2 (1192.0, 1012.0): тип=L, направления=left, up
  Junction 3 (947.0, 416.0): тип=L, направления=right, up
  Junction 4 (327.0, 895.0): тип=L, направления=right, up
  Junction 5 (899.0, 1012.0): тип=L, направления=right, up
  Junction 6 (327.0, 70.0): тип=L, направления=right, down
  Junction 7 (1191.0, 70.0): тип=L, направления=left, down
  Junction 8 (947.0, 329.0): тип=unknown, направления=down
  Junction 9 (898.0, 895.0): тип=L, направления=left, down
  Junction 10 (721.0, 71.0): тип=T, направления=left, right, down
  Junction 11 (583.0, 652.0): тип=T, направления=left, right, down
  Junction 12 (1192.0, 415.0): тип=T, направления=left, up, down
  Junction 13 (721.0, 459.0): тип=unknown, направления=left
  Junction 14 (1192.0, 651.0): тип=T, направления=left, up, down
  Junction 15 (585.0, 897.0): тип=T, направления=left, right, up
  Junction 16 (723.0, 897.0): тип=T, направления=left, right, up
  Junction 17 (722.0, 329.0): тип=T, направления=right, up, down
  Junction 18 (326.0, 458.0): тип=T, направления=right, up, down
  Junction 19 (326.0, 648.0): тип=T, направления=right, up, down
  Junction 20 (722.0, 649.0): тип=T, направления=left, right, up
  Junction 21 (398.0, 70.0): тип=unknown, направления=left
  Junction 22 (966.0, 70.0): тип=unknown, направления=left
  Junction 23 (848.0, 330.0): тип=unknown (не внутри полигона)
  Junction 24 (757.0, 649.0): тип=unknown (не внутри полигона)
  Junction 25 (760.0, 650.0): тип=unknown (не внутри полигона)
  Junction 26 (754.0, 894.0): тип=unknown, направления=left
  Junction 27 (387.0, 895.0): тип=unknown, направления=left
  Junction 28 (931.0, 1012.0): тип=unknown, направления=left
  Junction 29 (553.0, 70.0): тип=unknown, направления=right
  Junction 30 (1121.0, 70.0): тип=unknown, направления=right
  Junction 31 (927.0, 330.0): тип=unknown (не внутри полигона)
  Junction 32 (837.0, 649.0): тип=unknown (не внутри полигона)
  Junction 33 (846.0, 895.0): тип=unknown (не внутри полигона)
  Junction 34 (479.0, 896.0): тип=unknown (не внутри полигона)
  Junction 35 (1156.0, 1012.0): тип=unknown (не внутри полигона)
  Junction 36 (724.0, 356.0): тип=unknown (не внутри полигона)
  Junction 37 (1191.0, 446.0): тип=unknown (не внутри полигона)
  Junction 38 (721.0, 477.0): тип=unknown (не внутри полигона)
  Junction 39 (327.0, 486.0): тип=unknown (не внутри полигона)
  Junction 40 (1191.0, 555.0): тип=unknown (не внутри полигона)
  Junction 41 (584.0, 736.0): тип=unknown (не внутри полигона)
  Junction 42 (719.0, 435.0): тип=unknown (не внутри полигона)
  Junction 43 (724.0, 436.0): тип=unknown (не внутри полигона)
  Junction 44 (1192.0, 509.0): тип=unknown, направления=down
  Junction 45 (724.0, 548.0): тип=unknown (не внутри полигона)
  Junction 46 (327.0, 549.0): тип=unknown (не внутри полигона)
  Junction 47 (721.0, 549.0): тип=unknown (не внутри полигона)
  Junction 48 (1192.0, 616.0): тип=unknown (не внутри полигона)
  Junction 49 (584.0, 807.0): тип=unknown (не внутри полигона)
  Junction 50 (1084.0, 519.0): тип=unknown (не внутри полигона)
  Junction 51 (892.0, 535.0): тип=unknown (не внутри полигона)
  Junction 52 (891.0, 538.0): тип=unknown (не внутри полигона)
  Junction 53 (1080.0, 425.0): тип=straight, направления=left, right
  Junction 54 (1078.0, 537.0): тип=unknown (не внутри полигона)
  Junction 55 (891.0, 637.0): тип=unknown (не внутри полигона)
  Junction 56 (891.0, 640.0): тип=straight, направления=left, right
  Junction 57 (916.0, 640.0): тип=straight, направления=left, right
  Junction 58 (1056.0, 640.0): тип=straight, направления=left, right
  Junction 59 (1080.0, 525.0): тип=unknown (не внутри полигона)
  Junction 60 (1077.0, 638.0): тип=straight, направления=left, right
  Junction 61 (1080.0, 638.0): тип=straight, направления=left, right

Статистика типов junctions:
  unknown: 38
  L: 7
  T: 10
  straight: 6

============================================================
ПОИСК JUNCTIONS НЕ СВЯЗАННЫХ С ПРОЕМАМИ И ДОСТРАИВАНИЕ СТЕН
============================================================

--- Итерация 1 ---
  ✓ Найдено 33 junctions для обработки
  Обработка junction 1...
  Junction 1: существующие направления=[], требуемые=['up'], недостающие=['up']
    ✗ Кандидат J20 за пределами полигона (up до 671.5), пробуем следующего
    ✗ Кандидат J47 не подтверждает соединение (нет down и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J45 не подтверждает соединение (нет down и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J38 не подтверждает соединение (нет down и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J13 не подтверждает соединение (нет down и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J43 не подтверждает соединение (нет down и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J42 не подтверждает соединение (нет down и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J36 не подтверждает соединение (нет down и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J17 за пределами полигона (up до 671.5), пробуем следующего
    ✗ Кандидат J10 за пределами полигона (up до 671.5), пробуем следующего
    → Нет подходящего узла; создаем сегмент до края полигона в направлении up
    ✓ Создан сегмент от J1 до края полигона (up)

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J1 до J62
  ✓ Создано 1 новых уникальных сегментов для junction 1
  Обработка junction 2...
  Junction 2: существующие направления=['left'], требуемые=['left', 'up'], недостающие=['up']
    ✓ Создан сегмент от J2 до J14 в направлении up

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J2 до J14
  ✓ Создано 1 новых уникальных сегментов для junction 2
  Обработка junction 3...
  Junction 3: существующие направления=[], требуемые=['right', 'up'], недостающие=['right', 'up']
    ✓ Создан сегмент от J3 до J53 в направлении right
    ✓ Создан сегмент от J3 до J8 в направлении up

  ✓ Создано 2 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J3 до J53
    ✓ Создан уникальный сегмент от J3 до J8
  ✓ Создано 2 новых уникальных сегментов для junction 3
  Обработка junction 4...
  Junction 4: существующие направления=['right'], требуемые=['right', 'up'], недостающие=['up']
    ✓ Создан сегмент от J4 до J19 в направлении up

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J4 до J19
  ✓ Создано 1 новых уникальных сегментов для junction 4
  Обработка junction 5...
  Junction 5: существующие направления=['right'], требуемые=['right', 'up'], недостающие=['up']
    ✓ Создан сегмент от J5 до J9 в направлении up

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J5 до J9
  ✓ Создано 1 новых уникальных сегментов для junction 5
  Обработка junction 6...
  Junction 6: существующие направления=['right'], требуемые=['right', 'down'], недостающие=['down']
    ✓ Создан сегмент от J6 до J18 в направлении down

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J6 до J18
  ✓ Создано 1 новых уникальных сегментов для junction 6
  Обработка junction 7...
  Junction 7: существующие направления=['left'], требуемые=['left', 'down'], недостающие=['down']
    ✓ Создан сегмент от J7 до J12 в направлении down

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J7 до J12
  ✓ Создано 1 новых уникальных сегментов для junction 7
  Обработка junction 9...
  Junction 9: существующие направления=['left', 'down'], требуемые=['left', 'down'], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 9
  Обработка junction 10...
  Junction 10: существующие направления=['left', 'right'], требуемые=['left', 'right', 'down'], недостающие=['down']
    ✓ Создан сегмент от J10 до J17 в направлении down

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J10 до J17
  ✓ Создано 1 новых уникальных сегментов для junction 10
  Обработка junction 11...
  Junction 11: существующие направления=['down'], требуемые=['left', 'right', 'down'], недостающие=['left', 'right']
    ✓ Создан сегмент от J11 до J19 в направлении left
    ✓ Создан сегмент от J11 до J20 в направлении right

  ✓ Создано 2 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J11 до J19
    ✓ Создан уникальный сегмент от J11 до J20
  ✓ Создано 2 новых уникальных сегментов для junction 11
  Обработка junction 12...
  Junction 12: существующие направления=['up', 'down'], требуемые=['left', 'up', 'down'], недостающие=['left']
    ✓ Создан сегмент от J12 до J53 в направлении left

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J12 до J53
  ✓ Создано 1 новых уникальных сегментов для junction 12
  Обработка junction 14...
  Junction 14: существующие направления=['up', 'down'], требуемые=['left', 'up', 'down'], недостающие=['left']
    ✗ Кандидат J32 не подтверждает соединение (нет right и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J25 не подтверждает соединение (нет right и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J24 не подтверждает соединение (нет right и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J20 за пределами полигона (left до 838.0), пробуем следующего
    ✗ Кандидат J11 за пределами полигона (left до 838.0), пробуем следующего
    ✗ Кандидат J19 за пределами полигона (left до 838.0), пробуем следующего
    → Нет подходящего узла; создаем сегмент до края полигона в направлении left
    ✓ Создан сегмент от J14 до края полигона (left)

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J14 до J63
  ✓ Создано 1 новых уникальных сегментов для junction 14
  Обработка junction 15...
  Junction 15: существующие направления=['left', 'up'], требуемые=['left', 'right', 'up'], недостающие=['right']
    ✓ Создан сегмент от J15 до J16 в направлении right

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J15 до J16
  ✓ Создано 1 новых уникальных сегментов для junction 15
  Обработка junction 16...
  Junction 16: существующие направления=['left', 'right'], требуемые=['left', 'right', 'up'], недостающие=['up']
    ✗ Кандидат J1 за пределами полигона (up до 817.0), пробуем следующего
    ✗ Кандидат J62 не подтверждает соединение (нет down и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J20 за пределами полигона (up до 817.0), пробуем следующего
    ✗ Кандидат J47 не подтверждает соединение (нет down и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J45 не подтверждает соединение (нет down и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J38 не подтверждает соединение (нет down и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J13 не подтверждает соединение (нет down и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J43 не подтверждает соединение (нет down и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J42 не подтверждает соединение (нет down и нет осевой компоненты), пробуем следующего
    ✗ Кандидат J36 не подтверждает соединение (нет down и нет осевой компоненты), пробуем следующего
    → Нет подходящего узла; создаем сегмент до края полигона в направлении up
    ✓ Создан сегмент от J16 до края полигона (up)

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J16 до J64
  ✓ Создано 1 новых уникальных сегментов для junction 16
  Обработка junction 17...
  Junction 17: существующие направления=['up', 'down', 'right'], требуемые=['right', 'up', 'down'], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 17
  Обработка junction 18...
  Junction 18: существующие направления=['up', 'down'], требуемые=['right', 'up', 'down'], недостающие=['right']
    ✓ Создан сегмент от J18 до J13 в направлении right

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J18 до J13
  ✓ Создано 1 новых уникальных сегментов для junction 18
  Обработка junction 19...
  Junction 19: существующие направления=['up', 'down', 'right'], требуемые=['right', 'up', 'down'], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 19
  Обработка junction 20...
  Junction 20: существующие направления=['up', 'right', 'left'], требуемые=['left', 'right', 'up'], недостающие=[]
    ✓ Вытянули вертикальный сегмент wall_junction_1_to_edge_up на 22.5px к J20 (down); bbox {'x': 710.5, 'y': 671.5, 'width': 21.0, 'height': 51.5, 'orientation': 'vertical'} -> {'x': 710.5, 'y': 649.0, 'width': 21.0, 'height': 74.0, 'orientation': 'vertical'}

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 20
  Обработка junction 25...
  Junction 25: существующие направления=['left'], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 25
  Обработка junction 43...
  Junction 43: существующие направления=['down'], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 43
  Обработка junction 45...
  Junction 45: существующие направления=['down'], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 45
  Обработка junction 50...
  Junction 50: существующие направления=[], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 50
  Обработка junction 51...
  Junction 51: существующие направления=[], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 51
  Обработка junction 52...
  Junction 52: существующие направления=[], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 52
  Обработка junction 53...
  Junction 53: существующие направления=['left', 'right'], требуемые=['left', 'right'], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 53
  Обработка junction 54...
  Junction 54: существующие направления=[], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 54
  Обработка junction 55...
  Junction 55: существующие направления=['left'], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 55
  Обработка junction 56...
  Junction 56: существующие направления=['left'], требуемые=['left', 'right'], недостающие=['right']
    ✓ Создан сегмент от J56 до J57 в направлении right

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J56 до J57
  ✓ Создано 1 новых уникальных сегментов для junction 56
  Обработка junction 57...
  Junction 57: существующие направления=['left'], требуемые=['left', 'right'], недостающие=['right']
    ✓ Создан сегмент от J57 до J58 в направлении right

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J57 до J58
  ✓ Создано 1 новых уникальных сегментов для junction 57
  Обработка junction 58...
  Junction 58: существующие направления=['left'], требуемые=['left', 'right'], недостающие=['right']
    ✓ Создан сегмент от J58 до J60 в направлении right

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J58 до J60
  ✓ Создано 1 новых уникальных сегментов для junction 58
  Обработка junction 59...
  Junction 59: существующие направления=[], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 59
  Обработка junction 60...
  Junction 60: существующие направления=['left'], требуемые=['left', 'right'], недостающие=['right']
    ✓ Создан сегмент от J60 до J61 в направлении right

  ✓ Создано 1 новых сегментов стен для junctions не связанных с проемами
    ✓ Создан уникальный сегмент от J60 до J61
  ✓ Создано 1 новых уникальных сегментов для junction 60
  Обработка junction 61...
  Junction 61: существующие направления=['left', 'right'], требуемые=['left', 'right'], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 61
  ✓ Добавлено 20 сегментов на итерации 1

--- Итерация 2 ---
  ✓ Найдено 10 junctions для обработки
  Обработка junction 25...
  Junction 25: существующие направления=['left'], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 25
  Обработка junction 43...
  Junction 43: существующие направления=['down'], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 43
  Обработка junction 45...
  Junction 45: существующие направления=['down'], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 45
  Обработка junction 50...
  Junction 50: существующие направления=[], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 50
  Обработка junction 51...
  Junction 51: существующие направления=[], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 51
  Обработка junction 52...
  Junction 52: существующие направления=[], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 52
  Обработка junction 54...
  Junction 54: существующие направления=[], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 54
  Обработка junction 55...
  Junction 55: существующие направления=['left', 'right'], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 55
  Обработка junction 59...
  Junction 59: существующие направления=[], требуемые=[], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 59
  Обработка junction 61...
  Junction 61: существующие направления=['left', 'right'], требуемые=['left', 'right'], недостающие=[]

  ✓ Создано 0 новых сегментов стен для junctions не связанных с проемами
  ✗ Не удалось создать сегменты для junction 61
  ✓ Новые сегменты стен не найдены на итерации 2
  ✓ Переопределение типа J8: unknown -> L (по подключенным сегментам: H=1, V=1)
  ✓ Переопределение типа J13: unknown -> L (по подключенным сегментам: H=1, V=2)
  ✓ Переопределили тип на L по связям: 2 узлов

============================================================
ОБРАБОТКА L-JUNCTIONS И РАСШИРЕНИЕ ОРИГИНАЛЬНЫХ СЕГМЕНТОВ
============================================================
  ✓ Найдено 9 L-junctions
  Обработка L-junction 2 (1192.0, 1012.0)
    ✓ Выбран сегмент для расширения: wall_window_1_right_35_to_2
    ✓ Оригинальные границы segment bbox: {'x': 1156.0, 'y': 1000.5, 'width': 36.0, 'height': 21.0, 'orientation': 'horizontal'}
    → Шаг 1: Расширение до границы полигона...
    ✗ Сегмент wall_window_1_right_35_to_2 является стеной от проема, не расширяем влево
    ✓ Выбран перпендикулярный сегмент: wall_junction_2_to_14_up
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Сегмент wall_window_1_right_35_to_2 расширен вправо до 1202.5
    ✓ После расширения до перпендикуляра: {'x': 1156.0, 'y': 1000.5, 'width': 46.5, 'height': 21.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_window_1_right_35_to_2 расширен
      оригинал: {'x': 1156.0, 'y': 1000.5, 'width': 36.0, 'height': 21.0, 'orientation': 'horizontal'}
      результат: {'x': 1156.0, 'y': 1000.5, 'width': 46.5, 'height': 21.0, 'orientation': 'horizontal'}
  Обработка L-junction 3 (947.0, 416.0)
    ✓ Выбран сегмент для расширения: wall_junction_3_to_53_right
    ✓ Оригинальные границы segment bbox: {'x': 947.0, 'y': 405.5, 'width': 133.0, 'height': 21.0, 'orientation': 'horizontal'}
    → Шаг 1: Расширение до границы полигона...
    ✓ Сегмент wall_junction_3_to_53_right расширен вправо до 1201.0
    ✓ После расширения до границы полигона: {'x': 947.0, 'y': 405.5, 'width': 254.0, 'height': 21.0, 'orientation': 'horizontal'}
    ✓ Выбран перпендикулярный сегмент: wall_junction_3_to_8_up
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Сегмент wall_junction_3_to_53_right расширен влево до 936.5
    ✓ После расширения до перпендикуляра: {'x': 936.5, 'y': 405.5, 'width': 264.5, 'height': 21.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_junction_3_to_53_right расширен
      оригинал: {'x': 947.0, 'y': 405.5, 'width': 133.0, 'height': 21.0, 'orientation': 'horizontal'}
      результат: {'x': 936.5, 'y': 405.5, 'width': 264.5, 'height': 21.0, 'orientation': 'horizontal'}
  Обработка L-junction 4 (327.0, 895.0)
    ✓ Выбран сегмент для расширения: wall_window_4_left_27_to_4
    ✓ Оригинальные границы segment bbox: {'x': 327.0, 'y': 884.5, 'width': 60.0, 'height': 21.0, 'orientation': 'horizontal'}
    → Шаг 1: Расширение до границы полигона...
    ✓ Сегмент wall_window_4_left_27_to_4 расширен вправо до 388.2857142857143
    ✓ После расширения до границы полигона: {'x': 327.0, 'y': 884.5, 'width': 61.28571428571428, 'height': 21.0, 'orientation': 'horizontal'}
    ✓ Выбран перпендикулярный сегмент: wall_junction_4_to_19_up
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Сегмент wall_window_4_left_27_to_4 расширен влево до 316.5
    ✓ После расширения до перпендикуляра: {'x': 316.5, 'y': 884.5, 'width': 71.78571428571428, 'height': 21.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_window_4_left_27_to_4 расширен
      оригинал: {'x': 327.0, 'y': 884.5, 'width': 60.0, 'height': 21.0, 'orientation': 'horizontal'}
      результат: {'x': 316.5, 'y': 884.5, 'width': 71.78571428571428, 'height': 21.0, 'orientation': 'horizontal'}
  Обработка L-junction 5 (899.0, 1012.0)
    ✓ Выбран сегмент для расширения: wall_window_1_left_28_to_5
    ✓ Оригинальные границы segment bbox: {'x': 899.0, 'y': 1000.5, 'width': 32.0, 'height': 21.0, 'orientation': 'horizontal'}
    → Шаг 1: Расширение до границы полигона...
    ✓ Сегмент wall_window_1_left_28_to_5 расширен вправо до 932.0
    ✓ После расширения до границы полигона: {'x': 899.0, 'y': 1000.5, 'width': 33.0, 'height': 21.0, 'orientation': 'horizontal'}
    ✓ Выбран перпендикулярный сегмент: wall_junction_5_to_9_up
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Сегмент wall_window_1_left_28_to_5 расширен влево до 888.5
    ✓ После расширения до перпендикуляра: {'x': 888.5, 'y': 1000.5, 'width': 43.5, 'height': 21.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_window_1_left_28_to_5 расширен
      оригинал: {'x': 899.0, 'y': 1000.5, 'width': 32.0, 'height': 21.0, 'orientation': 'horizontal'}
      результат: {'x': 888.5, 'y': 1000.5, 'width': 43.5, 'height': 21.0, 'orientation': 'horizontal'}
  Обработка L-junction 6 (327.0, 70.0)
    ✓ Выбран сегмент для расширения: wall_window_3_left_21_to_6
    ✓ Оригинальные границы segment bbox: {'x': 327.0, 'y': 58.5, 'width': 71.0, 'height': 21.0, 'orientation': 'horizontal'}
    → Шаг 1: Расширение до границы полигона...
    ✓ Сегмент wall_window_3_left_21_to_6 расширен вправо до 400.0
    ✓ После расширения до границы полигона: {'x': 327.0, 'y': 58.5, 'width': 73.0, 'height': 21.0, 'orientation': 'horizontal'}
    ✓ Выбран перпендикулярный сегмент: wall_junction_6_to_18_down
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Сегмент wall_window_3_left_21_to_6 расширен влево до 316.5
    ✓ После расширения до перпендикуляра: {'x': 316.5, 'y': 58.5, 'width': 83.5, 'height': 21.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_window_3_left_21_to_6 расширен
      оригинал: {'x': 327.0, 'y': 58.5, 'width': 71.0, 'height': 21.0, 'orientation': 'horizontal'}
      результат: {'x': 316.5, 'y': 58.5, 'width': 83.5, 'height': 21.0, 'orientation': 'horizontal'}
  Обработка L-junction 7 (1191.0, 70.0)
    ✓ Выбран сегмент для расширения: wall_window_2_right_30_to_7
    ✓ Оригинальные границы segment bbox: {'x': 1121.0, 'y': 58.5, 'width': 70.0, 'height': 21.0, 'orientation': 'horizontal'}
    → Шаг 1: Расширение до границы полигона...
    ✗ Сегмент wall_window_2_right_30_to_7 является стеной от проема, не расширяем влево
    ✓ Выбран перпендикулярный сегмент: wall_junction_7_to_12_down
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Сегмент wall_window_2_right_30_to_7 расширен вправо до 1201.5
    ✓ После расширения до перпендикуляра: {'x': 1121.0, 'y': 58.5, 'width': 80.5, 'height': 21.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_window_2_right_30_to_7 расширен
      оригинал: {'x': 1121.0, 'y': 58.5, 'width': 70.0, 'height': 21.0, 'orientation': 'horizontal'}
      результат: {'x': 1121.0, 'y': 58.5, 'width': 80.5, 'height': 21.0, 'orientation': 'horizontal'}
  Обработка L-junction 8 (947.0, 329.0)
    ✓ Выбран сегмент для расширения: wall_door_2_right_31_to_8
    ✓ Оригинальные границы segment bbox: {'x': 927.0, 'y': 318.0, 'width': 20.0, 'height': 21.0, 'orientation': 'horizontal'}
    → Шаг 1: Расширение до границы полигона...
    ✗ Сегмент wall_door_2_right_31_to_8 является стеной от проема, не расширяем влево
    ✓ Выбран перпендикулярный сегмент: wall_junction_3_to_8_up
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Сегмент wall_door_2_right_31_to_8 расширен вправо до 957.5
    ✓ После расширения до перпендикуляра: {'x': 927.0, 'y': 318.0, 'width': 30.5, 'height': 21.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_door_2_right_31_to_8 расширен
      оригинал: {'x': 927.0, 'y': 318.0, 'width': 20.0, 'height': 21.0, 'orientation': 'horizontal'}
      результат: {'x': 927.0, 'y': 318.0, 'width': 30.5, 'height': 21.0, 'orientation': 'horizontal'}
  Обработка L-junction 9 (898.0, 895.0)
    ✓ Выбран сегмент для расширения: wall_window_5_right_33_to_9
    ✓ Оригинальные границы segment bbox: {'x': 846.0, 'y': 884.5, 'width': 52.0, 'height': 21.0, 'orientation': 'horizontal'}
    → Шаг 1: Расширение до границы полигона...
    ✗ Сегмент wall_window_5_right_33_to_9 является стеной от проема, не расширяем влево
    ✓ Выбран перпендикулярный сегмент: wall_junction_5_to_9_up
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Сегмент wall_window_5_right_33_to_9 расширен вправо до 909.5
    ✓ После расширения до перпендикуляра: {'x': 846.0, 'y': 884.5, 'width': 63.5, 'height': 21.0, 'orientation': 'horizontal'}
    ✓ Итог: Сегмент wall_window_5_right_33_to_9 расширен
      оригинал: {'x': 846.0, 'y': 884.5, 'width': 52.0, 'height': 21.0, 'orientation': 'horizontal'}
      результат: {'x': 846.0, 'y': 884.5, 'width': 63.5, 'height': 21.0, 'orientation': 'horizontal'}
  Обработка L-junction 13 (721.0, 459.0)
    ✓ Выбран сегмент для расширения: wall_door_1_bottom_42_to_13
    ✓ Оригинальные границы segment bbox: {'x': 709.5, 'y': 435.0, 'width': 21.0, 'height': 23.0, 'orientation': 'vertical'}
    → Шаг 1: Расширение до границы полигона...
    ✓ Сегмент wall_door_1_bottom_42_to_13 расширен вверх до 438.8
    ✓ После расширения до границы полигона: {'x': 709.5, 'y': 438.8, 'width': 21.0, 'height': 19.19999999999999, 'orientation': 'vertical'}
    ✓ Выбран перпендикулярный сегмент: wall_door_4_top_38_to_13
    → Шаг 2: Расширение до перпендикулярного сегмента...
    ✓ Итог: Сегмент wall_door_1_bottom_42_to_13 расширен
      оригинал: {'x': 709.5, 'y': 435.0, 'width': 21.0, 'height': 23.0, 'orientation': 'vertical'}
      результат: {'x': 709.5, 'y': 438.8, 'width': 21.0, 'height': 19.19999999999999, 'orientation': 'vertical'}
  ✓ Расширено 13 сегментов для L-junctions

============================================================
ОБНОВЛЕНИЕ JSON ДАННЫХ С РАСШИРЕННЫМИ СЕГМЕНТАМИ
============================================================
  ✓ Обновлен сегмент из проема: wall_window_2_left_22_to_10
  ✓ Обновлен сегмент из проема: wall_window_2_right_30_to_7
  ✓ Обновлен сегмент из проема: wall_window_3_left_21_to_6
  ✓ Обновлен сегмент из проема: wall_window_3_right_29_to_10
  ✓ Обновлен сегмент из проема: wall_window_4_left_27_to_4
  ✓ Обновлен сегмент из проема: wall_window_4_right_34_to_15
  ✓ Обновлен сегмент из проема: wall_window_5_left_26_to_16
  ✓ Обновлен сегмент из проема: wall_window_5_right_33_to_9
  ✓ Обновлен сегмент из проема: wall_window_6_top_40_to_44
  ✓ Обновлен сегмент из проема: wall_window_6_bottom_48_to_14
  ✓ Обновлен сегмент из проема: wall_window_7_top_37_to_12
  ✓ Обновлен сегмент из проема: wall_window_7_bottom_44_to_40
  ✓ Обновлен сегмент из проема: wall_door_1_top_36_to_17
  ✓ Обновлен сегмент из проема: wall_door_1_bottom_42_to_13
  ✓ Обновлен сегмент из проема: wall_door_4_top_38_to_13
  ✓ Обновлен сегмент из проема: wall_door_4_bottom_47_to_20
  ✓ Обновлен сегмент из проема: wall_window_1_left_28_to_5
  ✓ Обновлен сегмент из проема: wall_window_1_right_35_to_2
  ✓ Обновлен сегмент из проема: wall_window_8_top_39_to_18
  ✓ Обновлен сегмент из проема: wall_window_8_bottom_46_to_19
  ✓ Обновлен сегмент из проема: wall_door_2_left_23_to_17
  ✓ Обновлен сегмент из проема: wall_door_2_right_31_to_8
  ✓ Обновлен сегмент из проема: wall_door_3_left_24_to_20
  ✓ Обновлен сегмент из проема: wall_door_3_right_32_to_56
  ✓ Обновлен сегмент из проема: wall_door_5_top_41_to_11
  ✓ Обновлен сегмент из проема: wall_door_5_bottom_49_to_15
  ✓ Обновлен сегмент из junction: wall_junction_1_to_edge_up
  ✓ Обновлен сегмент из junction: wall_junction_2_to_14_up
  ✓ Обновлен сегмент из junction: wall_junction_3_to_53_right
  ✓ Обновлен сегмент из junction: wall_junction_3_to_8_up
  ✓ Обновлен сегмент из junction: wall_junction_4_to_19_up
  ✓ Обновлен сегмент из junction: wall_junction_5_to_9_up
  ✓ Обновлен сегмент из junction: wall_junction_6_to_18_down
  ✓ Обновлен сегмент из junction: wall_junction_7_to_12_down
  ✓ Обновлен сегмент из junction: wall_junction_10_to_17_down
  ✓ Обновлен сегмент из junction: wall_junction_11_to_19_left
  ✓ Обновлен сегмент из junction: wall_junction_11_to_20_right
  ✓ Обновлен сегмент из junction: wall_junction_12_to_53_left
  ✓ Обновлен сегмент из junction: wall_junction_14_to_edge_left
  ✓ Обновлен сегмент из junction: wall_junction_15_to_16_right
  ✓ Обновлен сегмент из junction: wall_junction_16_to_edge_up
  ✓ Обновлен сегмент из junction: wall_junction_18_to_13_right
  ✓ Обновлен сегмент из junction: wall_junction_56_to_57_right
  ✓ Обновлен сегмент из junction: wall_junction_57_to_58_right
  ✓ Обновлен сегмент из junction: wall_junction_58_to_60_right
  ✓ Обновлен сегмент из junction: wall_junction_60_to_61_right
  ✓ JSON данные обновлены с 13 расширенными сегментами

============================================================
ДОБАВЛЕНИЕ ПРИВЯЗОК JUNCTIONS К СТЕНАМ
============================================================
  Обновление junctions привязками к сегментам стен...
  ✓ Обновление junctions завершено

============================================================
ВЫРАВНИВАНИЕ СТЕН ПО ПРОЕМАМ
============================================================
  Проверка на дубликаты сегментов:
    Сегменты из проемов: 26
    Сегменты из junctions: 20
  Начинаем выравнивание 26 сегментов из проемов и 20 сегментов из junctions
  ✓ Толщина стен определена по минимальной толщине дверей: 21.0 px
  ✓ Конвертировано 46 сегментов в единый формат
  ✓ Разделено на 25 горизонтальных и 21 вертикальных стен
  Обрабатываем горизонтальные стены...
  ✓ Найдено 6 групп горизонтальных стен
    Группа на Y=58.5: 4 стен
      Стена wall_window_2_left_22_to_10: bbox={'x': 721.0, 'y': 58.5, 'width': 245.0, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_window_2_right_30_to_7: bbox={'x': 1121.0, 'y': 58.5, 'width': 80.5, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_window_3_left_21_to_6: bbox={'x': 316.5, 'y': 58.5, 'width': 83.5, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_window_3_right_29_to_10: bbox={'x': 553.0, 'y': 58.5, 'width': 168.0, 'height': 21.0, 'orientation': 'horizontal'}
      Найдено 2 связанных проемов
    ✓ Стена wall_window_2_left_22_to_10: Y 58.5 -> 58.5 (по проему window_3)
    ✓ Стена wall_window_2_right_30_to_7: Y 58.5 -> 58.5 (по проему window_3)
    ✓ Стена wall_window_3_left_21_to_6: Y 58.5 -> 58.5 (по проему window_3)
    ✓ Стена wall_window_3_right_29_to_10: Y 58.5 -> 58.5 (по проему window_3)
    Группа на Y=884.5: 5 стен
      Стена wall_window_4_left_27_to_4: bbox={'x': 316.5, 'y': 884.5, 'width': 71.78571428571428, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_window_4_right_34_to_15: bbox={'x': 479.0, 'y': 884.5, 'width': 106.0, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_window_5_left_26_to_16: bbox={'x': 723.0, 'y': 884.5, 'width': 31.0, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_window_5_right_33_to_9: bbox={'x': 846.0, 'y': 884.5, 'width': 63.5, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_junction_15_to_16_right: bbox={'x': 585.0, 'y': 886.5, 'width': 138.0, 'height': 21.0, 'orientation': 'horizontal'}
      Найдено 2 связанных проемов
    ✓ Стена wall_window_4_left_27_to_4: Y 884.5 -> 884.5 (по проему window_5)
    ✓ Стена wall_window_4_right_34_to_15: Y 884.5 -> 884.5 (по проему window_5)
    ✓ Стена wall_window_5_left_26_to_16: Y 884.5 -> 884.5 (по проему window_5)
    ✓ Стена wall_window_5_right_33_to_9: Y 884.5 -> 884.5 (по проему window_5)
    ✓ Стена wall_junction_15_to_16_right: Y 886.5 -> 884.5 (по проему window_5)
    Группа на Y=1000.5: 2 стен
      Стена wall_window_1_left_28_to_5: bbox={'x': 888.5, 'y': 1000.5, 'width': 43.5, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_window_1_right_35_to_2: bbox={'x': 1156.0, 'y': 1000.5, 'width': 46.5, 'height': 21.0, 'orientation': 'horizontal'}
      Найдено 1 связанных проемов
    ✓ Стена wall_window_1_left_28_to_5: Y 1000.5 -> 1000.5 (по проему window_1)
    ✓ Стена wall_window_1_right_35_to_2: Y 1000.5 -> 1000.5 (по проему window_1)
    Группа на Y=318.0: 2 стен
      Стена wall_door_2_left_23_to_17: bbox={'x': 722.0, 'y': 318.0, 'width': 126.0, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_door_2_right_31_to_8: bbox={'x': 927.0, 'y': 318.0, 'width': 30.5, 'height': 21.0, 'orientation': 'horizontal'}
      Найдено 1 связанных проемов
    ✓ Стена wall_door_2_left_23_to_17: Y 318.0 -> 318.0 (по проему door_2)
    ✓ Стена wall_door_2_right_31_to_8: Y 318.0 -> 318.0 (по проему door_2)
    Группа на Y=638.5: 9 стен
      Стена wall_door_3_left_24_to_20: bbox={'x': 722.0, 'y': 638.5, 'width': 35.0, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_door_3_right_32_to_56: bbox={'x': 837.0, 'y': 638.5, 'width': 54.0, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_junction_11_to_19_left: bbox={'x': 326.0, 'y': 641.5, 'width': 257.0, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_junction_11_to_20_right: bbox={'x': 583.0, 'y': 641.5, 'width': 139.0, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_junction_14_to_edge_left: bbox={'x': 838.0, 'y': 640.5, 'width': 354.0, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_junction_56_to_57_right: bbox={'x': 891.0, 'y': 629.5, 'width': 25.0, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_junction_57_to_58_right: bbox={'x': 916.0, 'y': 629.5, 'width': 140.0, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_junction_58_to_60_right: bbox={'x': 1056.0, 'y': 629.5, 'width': 21.0, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_junction_60_to_61_right: bbox={'x': 1077.0, 'y': 627.5, 'width': 3.0, 'height': 21.0, 'orientation': 'horizontal'}
      Найдено 1 связанных проемов
    ✓ Стена wall_door_3_left_24_to_20: Y 638.5 -> 638.5 (по проему door_3)
    ✓ Стена wall_door_3_right_32_to_56: Y 638.5 -> 638.5 (по проему door_3)
    ✓ Стена wall_junction_11_to_19_left: Y 641.5 -> 638.5 (по проему door_3)
    ✓ Стена wall_junction_11_to_20_right: Y 641.5 -> 638.5 (по проему door_3)
    ✓ Стена wall_junction_14_to_edge_left: Y 640.5 -> 638.5 (по проему door_3)
    ✓ Стена wall_junction_56_to_57_right: Y 629.5 -> 638.5 (по проему door_3)
    ✓ Стена wall_junction_57_to_58_right: Y 629.5 -> 638.5 (по проему door_3)
    ✓ Стена wall_junction_58_to_60_right: Y 629.5 -> 638.5 (по проему door_3)
    ✓ Стена wall_junction_60_to_61_right: Y 627.5 -> 638.5 (по проему door_3)
    Группа на Y=405.5: 2 стен
      Стена wall_junction_3_to_53_right: bbox={'x': 936.5, 'y': 405.5, 'width': 264.5, 'height': 21.0, 'orientation': 'horizontal'}
      Стена wall_junction_12_to_53_left: bbox={'x': 1080.0, 'y': 404.5, 'width': 112.0, 'height': 21.0, 'orientation': 'horizontal'}
      Найдено 0 связанных проемов
      Проемы не найдены, ищем полигоны стен для выравнивания...
      Количество стен в группе: 2
  Checking relationships for wall wall_junction_3_to_53_right
    DEBUG: Checking horizontal wall at (1068.8, 416.0)
      Found inside relationship with wall_polygon_6 (score: 100)
    Total relationships found: 1
  Checking relationships for wall wall_junction_12_to_53_left
    DEBUG: Checking horizontal wall at (1136.0, 415.0)
      Found inside relationship with wall_polygon_6 (score: 100)
    Total relationships found: 1
  Best polygon found: wall_polygon_6 with total score: 200
  Relationship details:
    wall_junction_3_to_53_right: inside (score: 100)
    wall_junction_12_to_53_left: inside (score: 100)
      Найден полигон для выравнивания: wall_polygon_6
    DEBUG: Checking horizontal wall at (1068.8, 420.4)
      Found inside relationship with wall_polygon_6 (score: 100)
    Total relationships found: 1
        Wall wall_junction_3_to_53_right: Y 405.5 -> 409.9
    DEBUG: Checking horizontal wall at (1136.0, 420.4)
      Found inside relationship with wall_polygon_6 (score: 100)
    Total relationships found: 1
        Wall wall_junction_12_to_53_left: Y 404.5 -> 409.9
  Обрабатываем вертикальные стены...
  ✓ Найдено 4 групп вертикальных стен
    Группа на X=1180.0: 6 стен
      Стена wall_window_6_top_40_to_44: bbox={'x': 1180.0, 'y': 511.0, 'width': 21.0, 'height': 44.0, 'orientation': 'vertical'}
      Стена wall_window_6_bottom_48_to_14: bbox={'x': 1180.0, 'y': 616.0, 'width': 21.0, 'height': 34.0, 'orientation': 'vertical'}
      Стена wall_window_7_top_37_to_12: bbox={'x': 1180.0, 'y': 416.0, 'width': 21.0, 'height': 30.0, 'orientation': 'vertical'}
      Стена wall_window_7_bottom_44_to_40: bbox={'x': 1180.0, 'y': 509.0, 'width': 21.0, 'height': 45.0, 'orientation': 'vertical'}
      Стена wall_junction_2_to_14_up: bbox={'x': 1181.5, 'y': 651.0, 'width': 21.0, 'height': 361.0, 'orientation': 'vertical'}
      Стена wall_junction_7_to_12_down: bbox={'x': 1180.5, 'y': 70.0, 'width': 21.0, 'height': 345.0, 'orientation': 'vertical'}
      Найдено 2 связанных проемов
    ✓ Стена wall_window_6_top_40_to_44: X 1180.0 -> 1180.0 (по проему window_6)
    ✓ Стена wall_window_6_bottom_48_to_14: X 1180.0 -> 1180.0 (по проему window_6)
    ✓ Стена wall_window_7_top_37_to_12: X 1180.0 -> 1180.0 (по проему window_6)
    ✓ Стена wall_window_7_bottom_44_to_40: X 1180.0 -> 1180.0 (по проему window_6)
    ✓ Стена wall_junction_2_to_14_up: X 1181.5 -> 1180.0 (по проему window_6)
    ✓ Стена wall_junction_7_to_12_down: X 1180.5 -> 1180.0 (по проему window_6)
    Группа на X=709.5: 7 стен
      Стена wall_door_1_top_36_to_17: bbox={'x': 709.5, 'y': 329.0, 'width': 21.0, 'height': 27.0, 'orientation': 'vertical'}
      Стена wall_door_1_bottom_42_to_13: bbox={'x': 709.5, 'y': 438.8, 'width': 21.0, 'height': 19.19999999999999, 'orientation': 'vertical'}
      Стена wall_door_4_top_38_to_13: bbox={'x': 709.5, 'y': 459.0, 'width': 21.0, 'height': 18.0, 'orientation': 'vertical'}
      Стена wall_door_4_bottom_47_to_20: bbox={'x': 709.5, 'y': 549.0, 'width': 21.0, 'height': 100.0, 'orientation': 'vertical'}
      Стена wall_junction_1_to_edge_up: bbox={'x': 710.5, 'y': 649.0, 'width': 21.0, 'height': 74.0, 'orientation': 'vertical'}
      Стена wall_junction_10_to_17_down: bbox={'x': 710.5, 'y': 71.0, 'width': 21.0, 'height': 258.0, 'orientation': 'vertical'}
      Стена wall_junction_16_to_edge_up: bbox={'x': 712.5, 'y': 817.0, 'width': 21.0, 'height': 80.0, 'orientation': 'vertical'}
      Найдено 2 связанных проемов
    ✓ Стена wall_door_1_top_36_to_17: X 709.5 -> 709.5 (по проему door_4)
    ✓ Стена wall_door_1_bottom_42_to_13: X 709.5 -> 709.5 (по проему door_4)
    ✓ Стена wall_door_4_top_38_to_13: X 709.5 -> 709.5 (по проему door_4)
    ✓ Стена wall_door_4_bottom_47_to_20: X 709.5 -> 709.5 (по проему door_4)
    ✓ Стена wall_junction_1_to_edge_up: X 710.5 -> 709.5 (по проему door_4)
    ✓ Стена wall_junction_10_to_17_down: X 710.5 -> 709.5 (по проему door_4)
    ✓ Стена wall_junction_16_to_edge_up: X 712.5 -> 709.5 (по проему door_4)
    Группа на X=316.0: 4 стен
      Стена wall_window_8_top_39_to_18: bbox={'x': 316.0, 'y': 457.0, 'width': 21.0, 'height': 29.0, 'orientation': 'vertical'}
      Стена wall_window_8_bottom_46_to_19: bbox={'x': 316.0, 'y': 549.0, 'width': 21.0, 'height': 98.0, 'orientation': 'vertical'}
      Стена wall_junction_4_to_19_up: bbox={'x': 316.5, 'y': 648.0, 'width': 21.0, 'height': 247.0, 'orientation': 'vertical'}
      Стена wall_junction_6_to_18_down: bbox={'x': 316.5, 'y': 70.0, 'width': 21.0, 'height': 388.0, 'orientation': 'vertical'}
      Найдено 1 связанных проемов
    ✓ Стена wall_window_8_top_39_to_18: X 316.0 -> 316.0 (по проему window_8)
    ✓ Стена wall_window_8_bottom_46_to_19: X 316.0 -> 316.0 (по проему window_8)
    ✓ Стена wall_junction_4_to_19_up: X 316.5 -> 316.0 (по проему window_8)
    ✓ Стена wall_junction_6_to_18_down: X 316.5 -> 316.0 (по проему window_8)
    Группа на X=572.5: 2 стен
      Стена wall_door_5_top_41_to_11: bbox={'x': 572.5, 'y': 652.0, 'width': 21.0, 'height': 84.0, 'orientation': 'vertical'}
      Стена wall_door_5_bottom_49_to_15: bbox={'x': 572.5, 'y': 807.0, 'width': 21.0, 'height': 90.0, 'orientation': 'vertical'}
      Найдено 1 связанных проемов
    ✓ Стена wall_door_5_top_41_to_11: X 572.5 -> 572.5 (по проему door_5)
    ✓ Стена wall_door_5_bottom_49_to_15: X 572.5 -> 572.5 (по проему door_5)
  ✓ Выравнивание завершено
  ✓ Выравнивание применено к 26 сегментам из проемов и 20 сегментам из junctions

============================================================
ИТОГО: 26 сегментов стен из проемов + 20 сегментов стен из junctions + 13 расширенных сегментов
Объединенный список для визуализации: 46 сегментов
============================================================

============================================================
СОХРАНЕНИЕ ДАННЫХ В JSON
============================================================
Сохранение данных в JSON: ./2_objects_wall_coordinates.json
  ✓ Данные успешно сохранены

============================================================
СОЗДАНИЕ SVG ИЗ JSON ДАННЫХ
============================================================
Создание SVG из JSON: ./2_objects_wall_coordinates.json
  ✓ Отрисовка 8 стеновых полигонов
  ✓ Отрисовка 0 колонн как квадратов
  ✓ Используем толщину стены: 21.0 px
  ✓ Размер квадрата колонны: 50.89 px
  ✓ Отрисовка 8 окон и 5 дверей с толщиной 21.0 px
  ✓ Легенда добавлена
  ✓ Заголовок добавлен
  ✓ SVG сохранен: ./2_objects_wall_polygons.svg

Статистика объектов:
  Полигоны стен: 8
  Сегменты стен из проемов: 26
  Сегменты стен из junctions: 20
  Расширенные сегменты: 13 (оригинальные сегменты увеличены)
  Выровненные стены: встроено в существующие сегменты
  Всего сегментов стен: 46
  Объединенный список для визуализации: 46
  Колонны: 0
  Квадраты колонн: 0
  Окна: 8
  Двери: 5
  Junctions: 64
  Толщина стен (минимальная толщина двери): 21.0 px

Статистика по типам junctions:
  unknown: 36
  L: 9
  T: 10
  straight: 6
  wall_end: 3

============================================================
КОПИРОВАНИЕ ОБЪЕКТОВ OUTLINE, FOUNDATION И STREET В ОСНОВНОЙ JSON
============================================================
  ✓ Исходный файл загружен: 2_objects.json
  ✓ Основной JSON файл загружен: ./2_objects_wall_coordinates.json
  ✓ Building outline добавлен: building_outline_1, 30 вершин
  ✓ Foundation добавлен: foundation_1, 4 вершин
  ✓ Street добавлен: street_1, 0 вершин
  ✓ Основной JSON файл обновлен: ./2_objects_wall_coordinates.json
  ✓ Копирование объектов завершено успешно

Готово! Векторная визуализация с измененной логикой расширения сегментов создана: ./2_objects_wall_polygons.svg
Данные координат сохранены в: ./2_objects_wall_coordinates.json
